<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="チンモクのブログ" href="https://www.chinmoku.cc/rss.xml"><link rel="alternate" type="application/atom+xml" title="チンモクのブログ" href="https://www.chinmoku.cc/atom.xml"><link rel="alternate" type="application/json" title="チンモクのブログ" href="https://www.chinmoku.cc/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="python"><link rel="canonical" href="https://www.chinmoku.cc/computer-science/python/django-tutorial/"><title>Django 网站全栈开发教程 - Python 入门教程 - 计算机科学 | Chinmoku = チンモクのブログ = 露の世は　露の世ながら　さりながら</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Django 网站全栈开发教程</h1><div class="meta"><span class="item" title="作成日：2021-11-03 00:12:44"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">投稿日</span> <time itemprop="dateCreated datePublished" datetime="2021-11-03T00:12:44+08:00">2021-11-03</time> </span><span class="item" title="単語数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">単語数</span> <span>40k</span> <span class="text">単語</span> </span><span class="item" title="読書の時間"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">読書の時間</span> <span>37 分</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="ナビゲーションバーの切り替え"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Chinmoku</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/63c1dba1b3794c5db420cb7f4bc7693e.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/bfb838db58324686a341b11d43b46db8.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/eb8c11c697724ee5b61e4e823660c9d2.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/4c7155cf9f3243f98807d9cf24fd7ce6.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/c8bb634d0ff9401d896172b9bc091488.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/1a1162dd883711ebb6edd017c2d2eca2.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">ホーム</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/" itemprop="item" rel="index" title="カテゴリ 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/Python%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" itemprop="item" rel="index" title="カテゴリ Python 入门教程"><span itemprop="name">Python 入门教程</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="ja"><link itemprop="mainEntityOfPage" href="https://www.chinmoku.cc/computer-science/python/django-tutorial/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="チンモク"><meta itemprop="description" content="露の世は　露の世ながら　さりながら, 本站主要以 Java 开发总结文章为主，也会向技术周边进行适当的扩展。此外，偶尔会更新部分其他学习或感兴趣的内容，如语言学习、文本翻译、文艺创作等。"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="チンモクのブログ"></span><div class="body md" itemprop="articleBody"><div class="note info"><p>这篇文章是在 Python 基础知识全通关的基础上进行的进阶学习。</p></div><div class="note danger"><p>注意：由于本博客主题使用 <code>Prism.js</code> 对代码段进行渲染，渲染过程中，会与代码块中的双 <code>&#123;</code> 和 <code>&#123;</code> + <code>%</code> 的语法产生冲突，因此，本文将所有相关符号都替换为 <code>&#123;.&#123;</code> 和 <code>&#123;.%</code> 形式，以解决代码渲染的问题。读者在阅读和拷贝代码的过程中，请务必注意该问题并忽略符号之间多出的 <code>.</code> ，如因此造成阅读上的不便，还请见谅。</p></div><h3 id="学习前提"><a class="anchor" href="#学习前提">#</a> 学习前提</h3><h4 id="知识储备要求"><a class="anchor" href="#知识储备要求">#</a> 知识储备要求</h4><ol><li>了解 Python 基础，如果不了解，请先行阅读《<a href="/computer-science/python/python-all-base/">Python 基础知识全通关</a>》。</li><li>拥有前端开发相关基础技能，至少包括：CSS、JS、HTML。</li><li>会使用常用的 Liunx 命令。</li></ol><h4 id="环境说明"><a class="anchor" href="#环境说明">#</a> 环境说明</h4><p>本篇文章在编写过程中，将以如下信息作为参考环境：</p><ol><li>系统信息：<span class="label primary">VMware 16.1.2</span> + <span class="label info">CentOS 8.4</span>, <span class="label info">windows10</span></li><li>Python 版本：<span class="label success">Python 3.9.6</span></li><li>开发工具：<span class="label danger">Pycharm</span></li><li>命令行工具：<span class="label warning">Termius</span></li></ol><blockquote><p>关于 linux 环境，本文仅在安装、部署等少数部分提供相关说明，其他大部分环境将在 windows 下进行。</p></blockquote><h3 id="简介"><a class="anchor" href="#简介">#</a> 简介</h3><p>Django 是一个由 Python 编写的一个开放源代码的 Web 应用框架，Django 本身基于 MVC 模型。</p><p>Django 框架使用 MTV 模式，但其本质上和 MVC 是一样的，也是为了各组件间保持松耦合关系，只是定义上有些许不同，Django 的 MTV 分别是指：</p><ol><li>Model：编写程序应有的功能，负责业务对象与数据库的映射（ORM）。</li><li>Template：负责如何把页面（html）展示给用户。</li><li>View：负责业务逻辑，并在适当时候调用 Model 和 Template。</li></ol><p>除了以上三层之外，还需要一个 URL 分发器，它的作用是将一个个 URL 的页面请求分发给不同的 View 处理，View 再调用相应的 Model 和 Template。</p><p><img data-src="https://img.xfc-exclave.com/2021/10/fe81387a526f303ff097080034e919de1635158549.jpg" alt="Python MTV"></p><h3 id="安装与初始化"><a class="anchor" href="#安装与初始化">#</a> 安装与初始化</h3><h4 id="虚拟环境安装"><a class="anchor" href="#虚拟环境安装">#</a> 虚拟环境安装</h4><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>pip3 list <span class="token comment"># 查看列表，检查是否存在 virtualenv</span></pre></td></tr><tr><td data-num="2"></td><td><pre>pip3 <span class="token function">install</span> virtualenv -i https://pypi.douban.com/simple <span class="token comment"># 不存在则安装</span></pre></td></tr></table></figure><div class="note danger"><p>注：安装 Python 环境，默认会安装 pip 工具包，可以通过如下命令统一指定镜像源：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>pip config <span class="token builtin class-name">set</span> global.index-url https://pypi.douban.com/simple/</pre></td></tr></table></figure></div><p>创建并进入虚拟环境：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 为简洁起见，此处将 cd 命令合并为长目录</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">mkdir</span> /app/projects/django_venv</pre></td></tr><tr><td data-num="3"></td><td><pre>virtualenv /app/projects/django_venv</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token builtin class-name">source</span> /app/projects/django_venv/bin/activate</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 此时虚拟环境已启动成功，命令行带有前缀 (django_venv)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>pip3 list</pre></td></tr></table></figure><p>如需退出虚拟环境，使用如下命令：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>deactivate <span class="token comment"># 退出虚拟环境</span></pre></td></tr></table></figure><blockquote><p>提示：</p><ol><li>如果在虚拟机创建过程中提示 <code>-bash: virtualenv: command not found</code> ，这是因为 <code>/usr/bin</code> 中还未创建软连接。</li><li>查找 virtualenv 所在位置： <code>find / -name virtualenv</code> （稍微耗时一点）。</li><li>创建 virtualenv 软连接： <code>ln -s /usr/local/bin/python3/bin/virtualenv /usr/bin/virtualenv</code> 。</li></ol></blockquote><h4 id="安装-django"><a class="anchor" href="#安装-django">#</a> 安装 Django</h4><p>进入虚拟环境，并为该虚拟环境安装 Django。</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>pip3 <span class="token function">install</span> <span class="token assign-left variable">django</span><span class="token operator">==</span><span class="token number">3.2</span>.8 -i https://pypi.douban.com/simple</pre></td></tr></table></figure><p>创建并启动网站工程：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">cd</span> /app/projects</pre></td></tr><tr><td data-num="2"></td><td><pre>django-admin startproject firstsite <span class="token comment"># 创建项目</span></pre></td></tr><tr><td data-num="3"></td><td><pre>python firstsite/manage.py runserver <span class="token comment"># 启动项目</span></pre></td></tr></table></figure><p>测试访问：</p><p><img data-src="https://img.xfc-exclave.com/2021/10/5f3532ce1015e2ee81c6a2c93e3969cf1635158673.png" alt="First Django"></p><blockquote><p>注：如需通过外部网络访问虚拟机内部提供的服务，需要配置相应的防火墙出入站规则。</p><p>另外，如需共享文件夹，可参考：</p><ul><li><span class="exturl" data-url="aHR0cHM6Ly96aHVhbmxhbi56aGlodS5jb20vcC8xNDY3NDU0MzE=">Win10 下与虚拟机中的 linux 共享文件夹</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzU0MDUzMy9hcnRpY2xlL2RldGFpbHMvMTA5MDAzNjY1">VMware 与 win10 共享文件夹</span></li></ul></blockquote><h4 id="windows-下安装"><a class="anchor" href="#windows-下安装">#</a> windows 下安装</h4><p>在 win10 环境下安装 python3 很简单，如果未安装，只需要在命令行输入 <code>python3</code> 即可进入微软商店免费获取，点击下载安装即可。</p><p>创建文件夹 <code>A:\python-venv\django_venv</code> 。</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>C:<span class="token punctuation">\</span>Users<span class="token punctuation">\</span>Administrator<span class="token operator">></span>virtualenv A:<span class="token punctuation">\</span>python-venv<span class="token punctuation">\</span>django_venv <span class="token comment"># 创建虚拟环境</span></pre></td></tr><tr><td data-num="2"></td><td><pre>A:<span class="token punctuation">\</span>python-venv<span class="token punctuation">\</span>django_venv<span class="token punctuation">\</span>Scripts<span class="token operator">></span>activate <span class="token comment"># 激活虚拟环境</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">(</span>django_venv<span class="token punctuation">)</span> A:<span class="token punctuation">\</span>python-venv<span class="token punctuation">\</span>django_venv<span class="token punctuation">\</span>Scripts<span class="token operator">></span>pip3 <span class="token function">install</span> <span class="token assign-left variable">django</span><span class="token operator">==</span><span class="token number">3.2</span>.8 -i https://pypi.douban.com/simple <span class="token comment"># 为虚拟环境安装 django</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">(</span>django_venv<span class="token punctuation">)</span> A:<span class="token punctuation">\</span>python-venv<span class="token punctuation">\</span>django_venv<span class="token punctuation">\</span>Scripts<span class="token operator">></span>cd A:<span class="token punctuation">\</span>pycharm-workspace</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">(</span>django_venv<span class="token punctuation">)</span> A:<span class="token punctuation">\</span>pycharm-workspace<span class="token operator">></span>django-admin startproject firstsite <span class="token comment"># 创建项目</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">(</span>django_venv<span class="token punctuation">)</span> A:<span class="token punctuation">\</span>pycharm-workspace<span class="token operator">></span>python firstsite/manage.py runserver <span class="token comment"># 启动项目</span></pre></td></tr></table></figure><blockquote><p>其实总体上，linux 和 windows 平台的安装没有太大区别。</p></blockquote><p>在 Pycharm 中，可以通过如下方式制定虚拟环境：</p><p><img data-src="https://img.xfc-exclave.com/2021/10/ccedb26db60dd0aee68a1d552f8826391635158698.png" alt="Pycharm venv"></p><p>在 Pycharm 中启动项目就更简单了，直接点击右上角的运行按钮即可。</p><h4 id="项目结构"><a class="anchor" href="#项目结构">#</a> 项目结构</h4><p>在 Pycharm 中配置好环境，后续操作在编辑器中进行，将会更加方便。</p><p>生成页面子应用：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>python manage.py startapp index</pre></td></tr></table></figure><p>执行完成后，目录结构如下图所示：</p><p><img data-src="https://img.xfc-exclave.com/2021/10/1e086365a34fdd07c562a3359b33b0ac1635158722.png" alt="Django Project Structure"></p><h4 id="项目配置"><a class="anchor" href="#项目配置">#</a> 项目配置</h4><p>与项目同名的子文件夹中存放了项目相关配置，部分文件说明如下：</p><ul><li><p><span class="exturl" data-url="aHR0cDovL3NldHRpbmdzLnB5">settings.py</span> - 项目配置</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 返回项目绝对路径</span></pre></td></tr><tr><td data-num="2"></td><td><pre>BASE_DIR <span class="token operator">=</span> Path<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>resolve<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>parent<span class="token punctuation">.</span>parent</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 数据加密，放置跨域攻击</span></pre></td></tr><tr><td data-num="5"></td><td><pre>SECRET_KEY <span class="token operator">=</span> <span class="token string">'django-insecure-7)s64=kl*o2zm$wc86k&amp;s(4*&amp;!%a)ecs_k&amp;jskmai2dmss10$8'</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 是否处于开发环境</span></pre></td></tr><tr><td data-num="8"></td><td><pre>DEBUG <span class="token operator">=</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># 白名单，* 表示所有</span></pre></td></tr><tr><td data-num="11"></td><td><pre>ALLOWED_HOSTS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment"># 应用注册</span></pre></td></tr><tr><td data-num="14"></td><td><pre>INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token string">'django.contrib.admin'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token string">'django.contrib.auth'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token string">'django.contrib.contenttypes'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token string">'django.contrib.sessions'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token string">'django.contrib.messages'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token string">'django.contrib.staticfiles'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token string">'index'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token comment"># 项目根路由</span></pre></td></tr><tr><td data-num="25"></td><td><pre>ROOT_URLCONF <span class="token operator">=</span> <span class="token string">'firstsite.urls'</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token comment"># 配置开发服务器</span></pre></td></tr><tr><td data-num="28"></td><td><pre>WSGI_APPLICATION <span class="token operator">=</span> <span class="token string">'firstsite.wsgi.application'</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment"># 配置数据库</span></pre></td></tr><tr><td data-num="31"></td><td><pre>DATABASES <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token string">'default'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token string">'ENGINE'</span><span class="token punctuation">:</span> <span class="token string">'django.db.backends.sqlite3'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token string">'NAME'</span><span class="token punctuation">:</span> BASE_DIR <span class="token operator">/</span> <span class="token string">'db.sqlite3'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token comment"># 用户密码加密</span></pre></td></tr><tr><td data-num="39"></td><td><pre>AUTH_PASSWORD_VALIDATORS <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django.contrib.auth.password_validation.UserAttributeSimilarityValidator'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django.contrib.auth.password_validation.MinimumLengthValidator'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="46"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django.contrib.auth.password_validation.CommonPasswordValidator'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'django.contrib.auth.password_validation.NumericPasswordValidator'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre><span class="token comment"># 网站默认语言 # zh-hans</span></pre></td></tr><tr><td data-num="55"></td><td><pre>LANGUAGE_CODE <span class="token operator">=</span> <span class="token string">'en-us'</span></pre></td></tr><tr><td data-num="56"></td><td><pre>TIME_ZONE <span class="token operator">=</span> <span class="token string">'UTC'</span> <span class="token comment"># 时区 Asia/Shanghai</span></pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token comment"># 模板配置</span></pre></td></tr><tr><td data-num="59"></td><td><pre>TEMPLATES <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>        <span class="token string">'BACKEND'</span><span class="token punctuation">:</span> <span class="token string">'django.template.backends.django.DjangoTemplates'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="62"></td><td><pre>        <span class="token string">'DIRS'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'templates'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment"># 指定模板文件位置：当前项目下的 templates 文件夹</span></pre></td></tr><tr><td data-num="63"></td><td><pre>        <span class="token string">'APP_DIRS'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="64"></td><td><pre>        <span class="token string">'OPTIONS'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>            <span class="token string">'context_processors'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="66"></td><td><pre>                <span class="token string">'django.template.context_processors.debug'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="67"></td><td><pre>                <span class="token string">'django.template.context_processors.request'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="68"></td><td><pre>                <span class="token string">'django.contrib.auth.context_processors.auth'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="69"></td><td><pre>                <span class="token string">'django.contrib.messages.context_processors.messages'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="70"></td><td><pre>            <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="71"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="72"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token comment"># 指定静态文件位置</span></pre></td></tr><tr><td data-num="76"></td><td><pre>STATICFILES_DIRS <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="78"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure></li><li><p><span class="exturl" data-url="aHR0cDovL3VybHMucHk=">urls.py</span> - 路由配置</p><p>编辑 <code>index/views.py</code></p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'Hello world'</span><span class="token punctuation">)</span>  <span class="token comment"># 返回数据</span></pre></td></tr></table></figure><p>在 <span class="exturl" data-url="aHR0cDovL3VybHMucHk=">urls.py</span> 中可以通过如下方式指定路由：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> index<span class="token punctuation">.</span>views <span class="token keyword">import</span> index</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment"># 路由绑定视图</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>此时运行并访问，页面将会输出 Hello world 字样。</p></li><li><p>templates - 模板配置</p><p>templates 目录下可创建 html 模板文件。</p><p>在 templates 同级目录下可创建 <code>static</code> 文件夹，用于存储静态文件，静态文件位置需要在 <span class="exturl" data-url="aHR0cDovL3NldHRpbmdzLnB5">settings.py</span> 中指定，见上文。</p><p>在 static 文件夹下，可放置图片、css 样式文件、js 脚本等，在模板文件中可通过如下方式引用：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>纯CSS计时器演示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>static/css/normalize.min.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>static/css/style.css<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>修改 index/views.py 中的 index 函数：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'index.html'</span><span class="token punctuation">)</span>  <span class="token comment"># 视图绑定模板</span></pre></td></tr></table></figure><blockquote><p>作为学习和效果展示，可以选择直接使用一些成品效果的代码，例如，可以从<span class="exturl" data-url="aHR0cHM6Ly93d3cuMTdzdWNhaS5jb20vcHJldmlldy8xNjczMzY1LzIwMTktMDYtMDgvanNxL2luZGV4Lmh0bWw=">纯 CSS 计时器演示</span>获取源码并在当前项目进行效果重现。</p><p>另外，Django 支持热修改，除配置文件之外，其他文件修改后，无需重启即可生效。</p></blockquote></li></ul><h4 id="django-基础命令"><a class="anchor" href="#django-基础命令">#</a> Django 基础命令</h4><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>django-admin startproject <span class="token punctuation">[</span>project_name<span class="token punctuation">]</span> <span class="token comment"># 初始化一个项目</span></pre></td></tr><tr><td data-num="2"></td><td><pre>python3 manage.py startapp <span class="token punctuation">[</span>app_name<span class="token punctuation">]</span> <span class="token comment"># 在项目内创建页面子应用</span></pre></td></tr><tr><td data-num="3"></td><td><pre>python3 manage.py shell <span class="token comment"># 进入代码调试模式</span></pre></td></tr><tr><td data-num="4"></td><td><pre>python3 manage.py makemigrations <span class="token comment"># 数据库创建更改文件</span></pre></td></tr><tr><td data-num="5"></td><td><pre>python3 manage.py migrate <span class="token comment"># 同步到数据库进行更新</span></pre></td></tr><tr><td data-num="6"></td><td><pre>python3 manage.py flush <span class="token comment"># 清空数据库</span></pre></td></tr><tr><td data-num="7"></td><td><pre>python3 manage.py runserver <span class="token number">0.0</span>.0.0:8000 <span class="token comment"># 启动服务</span></pre></td></tr></table></figure><h3 id="django-模板"><a class="anchor" href="#django-模板">#</a> Django 模板</h3><h4 id="准备工作"><a class="anchor" href="#准备工作">#</a> 准备工作</h4><ol><li><p>使用虚拟环境创建项目 <code>mydjango</code> 。</p></li><li><p>创建应用 <code>app</code> 。</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">-</span> app</pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token operator">-</span> migrations</pre></td></tr><tr><td data-num="3"></td><td><pre>    __init__<span class="token punctuation">.</span>py</pre></td></tr><tr><td data-num="4"></td><td><pre>  __init__<span class="token punctuation">.</span>py</pre></td></tr><tr><td data-num="5"></td><td><pre>  admin<span class="token punctuation">.</span>py # </pre></td></tr><tr><td data-num="6"></td><td><pre>  apps<span class="token punctuation">.</span>py # </pre></td></tr><tr><td data-num="7"></td><td><pre>  models<span class="token punctuation">.</span>py # 数据库连接文件</pre></td></tr><tr><td data-num="8"></td><td><pre>  tests<span class="token punctuation">.</span>py # 测试文件</pre></td></tr><tr><td data-num="9"></td><td><pre>  views<span class="token punctuation">.</span>py # 视图文件</pre></td></tr><tr><td data-num="10"></td><td><pre>  urls<span class="token punctuation">.</span>py  # 子路由信息，通过手动创建</pre></td></tr></table></figure><blockquote><p>注意：后文中会出现一些 <code>mydjango</code> 和 <code>app</code> ，并不是什么特殊名称，而是指当前项目和应用文件夹的名称，项目创建不同，自然就不同。</p></blockquote></li><li><p>尝试启动项目，确保没有问题。</p></li><li><p>在 mydjango 项目下创建文件夹 <code>templates</code> 和 <code>static</code> 分别用于存放模板文件和静态资源。</p></li><li><p>修改 mydjango/mydjango/settings.py 配置。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>ALLOWED_HOSTS <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'*'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token string">'django.contrib.admin'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token string">'django.contrib.auth'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token string">'django.contrib.contenttypes'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token string">'django.contrib.sessions'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token string">'django.contrib.messages'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token string">'django.contrib.staticfiles'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token string">'app'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment"># 模板配置</span></pre></td></tr><tr><td data-num="14"></td><td><pre>TEMPLATES <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token string">'BACKEND'</span><span class="token punctuation">:</span> <span class="token string">'django.template.backends.django.DjangoTemplates'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token string">'DIRS'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'templates'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 指定模板文件位置：当前项目下的 templates 文件夹</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token string">'APP_DIRS'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token string">'OPTIONS'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            <span class="token string">'context_processors'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                <span class="token string">'django.template.context_processors.debug'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                <span class="token string">'django.template.context_processors.request'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                <span class="token string">'django.contrib.auth.context_processors.auth'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                <span class="token string">'django.contrib.messages.context_processors.messages'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token comment"># 指定静态文件位置</span></pre></td></tr><tr><td data-num="31"></td><td><pre>STATICFILES_DIRS <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure></li></ol><h4 id="路由与模板"><a class="anchor" href="#路由与模板">#</a> 路由与模板</h4><p>在初始创建项目时，默认会指定如下路由：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>但在 app 目录下中也可以创建子路由，但其名称必须指定为 <code>urls.py</code> ：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'index/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Index<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'data/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Data<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>但是，如果要使子路由生效，必须在项目路由中进行指定：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> include</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'app.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>这样，当浏览器访问 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTo4MDAwL2luZGV4Lw==">http://127.0.0.1:8000/index/</span> 时，就会通过项目路由转到子路由，并最终交由子路由中指定的视图解析器 <code>views.Index</code> 进行解析。</p><p>在进行视图解析时，我们可以有如下两种解析形式：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 形式一：返回数据</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">Data</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 形式二：返回渲染后的模板</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">def</span> <span class="token function">Index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'title'</span><span class="token punctuation">:</span> <span class="token string">'My Resume!'</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">:</span> <span class="token string">'Chinmoku'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span></pre></td></tr></table></figure><p>当返回数据时，直接访问路由地址，即可获取到对应的数据。当返回视图模板时，会将参数传递到模板中，模板会解析参数，并补充到对应位置，此处使用到的模板如下：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh-CN<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>&#123;.&#123; title &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>姓名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;.&#123; author &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>这种 <code>&#123;.&#123; value &#125;&#125;</code> 的模板占位方式，被称为 Mustache 语法，这种语法应用其实很广，不仅是在 python 或 java 的一些模板引擎中用到，在一些前端场景中通常使用尤为广泛，如：Vue。</p><h4 id="模板列表"><a class="anchor" href="#模板列表">#</a> 模板：列表</h4><p>基本语法：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>&#123;.% for item in list %&#125;</pre></td></tr><tr><td data-num="2"></td><td><pre> 	... item display</pre></td></tr><tr><td data-num="3"></td><td><pre>&#123;.% endfor %&#125;</pre></td></tr></table></figure><p>视图文件返回数据列表：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">Index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    skills <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'java web'</span><span class="token punctuation">,</span> <span class="token string">'html/css/js'</span><span class="token punctuation">,</span> <span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'wx mini-program'</span><span class="token punctuation">,</span> <span class="token string">'sql'</span><span class="token punctuation">,</span> <span class="token string">'python'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'title'</span><span class="token punctuation">:</span> <span class="token string">'My Resume!'</span><span class="token punctuation">,</span> <span class="token string">'author'</span><span class="token punctuation">:</span> <span class="token string">'Chinmoku'</span><span class="token punctuation">,</span> <span class="token string">'skills'</span><span class="token punctuation">:</span> skills<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span></pre></td></tr></table></figure><p>在模板中对列表进行遍历：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh-CN<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>&#123;.&#123; title &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>作者：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;.&#123; author &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>我的技能：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token value css language-css"><span class="token property">text-indent</span><span class="token punctuation">:</span> 2em<span class="token punctuation">;</span></span><span class="token punctuation">"</span></span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>        &#123;.% for skill in skills %&#125;</pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&#123;.&#123; forloop.counter &#125;&#125;. &#123;.&#123; skill &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>        &#123;.% endfor %&#125;</pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>主技能：&#123;.&#123; skills.0 &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>这就是遍历的基本使用方式，但在遍历过程中，django 也提供了一些方法帮助我们获取循环相关的信息：</p><ol><li>forloop.counter</li><li>forloop.counter0：下标从 0 开始。</li><li>forloop.revcounter</li><li>forloop.revcounter0</li><li>forloop.first</li><li>forloop.last</li><li>empty</li></ol><blockquote><p>这些信息是一眼就能看懂的，相信不用多做解释，要是一眼看不懂，就多看一眼，你会懂的。</p></blockquote><h4 id="模板字典"><a class="anchor" href="#模板字典">#</a> 模板：字典</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">Index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token string">'info'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token number">1000</span><span class="token punctuation">,</span> <span class="token string">'birthday'</span><span class="token punctuation">:</span> <span class="token string">'xxxx-xx-xx xx:xx:xx'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span></pre></td></tr></table></figure><p>使用：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>生日：&#123;.&#123; info.birthday &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>年龄：&#123;.&#123; info.age &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><h4 id="模板过滤器"><a class="anchor" href="#模板过滤器">#</a> 模板：过滤器</h4><p>基本语法： <code>&#123;.&#123; var | filter_name: not_required_params &#125;&#125;</code> 。</p><p>过滤器的使用方式大概是这样：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>年龄：&#123;.&#123; info.age | add:18 &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>按照这样的使用方式，就可以将原有的值，通过某种规则，返回一个被计算或处理后的值，例如这里的自增 18。</p><p>这种类似的被 Django 内置支持的过滤器还有不少，可以在网上<span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vbGF2ZW5kZXIxMjIxL3AvMTIyOTk2ODguaHRtbA==">看一看</span>。</p><p>根据万物皆可套娃原则，过滤器也可以这样使用：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>年龄：&#123;.&#123; info.age | add:18 | divisibleby:5 | upper | linenumbers | length &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>以上是 Django 内置的过滤器，但在业务过程中，有时也需要对过滤器进行自定义，这里提供一下自定义过滤器的流程：</p><ol><li><p>在 app 应用下创建文件夹 <code>templatetags</code> （固定名称）。</p></li><li><p>在 templatetags 下创建文件，例如 <span class="exturl" data-url="aHR0cDovL215ZmlsdGVycy5weQ==">myfilters.py</span>（名称自定义）。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/templatetags/myfilters.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>template <span class="token keyword">import</span> Library</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>register <span class="token operator">=</span> Library<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># register 名字固定不可变</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token decorator annotation punctuation">@register<span class="token punctuation">.</span>filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'append'</span><span class="token punctuation">)</span>  <span class="token comment"># 不指定名字，就会使用函数名</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">years</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>  <span class="token comment"># 过滤之前的原值</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">return</span> value<span class="token punctuation">.</span>__str__<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">' '</span> <span class="token operator">+</span> param</pre></td></tr></table></figure></li><li><p>在模板中进行使用。</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre>&#123;.% load myfilters %&#125;</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>年龄：&#123;.&#123; info.age | append:'year(s)' &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr></table></figure></li></ol><blockquote><p>注意：自定义过滤器只支持两个参数，参数一是过滤前的原值，参数二是可选的过滤参数。</p></blockquote><h4 id="模板条件判断"><a class="anchor" href="#模板条件判断">#</a> 模板：条件判断</h4><p>基本语法：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>&#123;.% if condition1 %&#125;</pre></td></tr><tr><td data-num="2"></td><td><pre>   ... display 1</pre></td></tr><tr><td data-num="3"></td><td><pre>&#123;.% elif condition2 %&#125;</pre></td></tr><tr><td data-num="4"></td><td><pre>   ... display 2</pre></td></tr><tr><td data-num="5"></td><td><pre>&#123;.% else %&#125;</pre></td></tr><tr><td data-num="6"></td><td><pre>   ... display 3</pre></td></tr><tr><td data-num="7"></td><td><pre>&#123;.% endif %&#125;</pre></td></tr></table></figure><p>使用示例：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>称呼：王</pre></td></tr><tr><td data-num="2"></td><td><pre>    &#123;.% if info.age &lt; 35 %&#125; 叔叔</pre></td></tr><tr><td data-num="3"></td><td><pre>	&#123;.% elif info.age &lt; 80 %&#125; 大爷</pre></td></tr><tr><td data-num="4"></td><td><pre>    &#123;.% else %&#125; 老妖怪</pre></td></tr><tr><td data-num="5"></td><td><pre>    &#123;.% endif %&#125;</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>条件判断中，也支持与、或、非的判断，分别使用 and，or，not，不提。</p><h4 id="模板ifequal"><a class="anchor" href="#模板ifequal">#</a> 模板：ifequal</h4><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>&#123;.% ifequal user currentuser %&#125;</pre></td></tr><tr><td data-num="2"></td><td><pre>	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Welcome!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>&#123;.% endifequal %&#125;</pre></td></tr></table></figure><p>与之相反的是 <code>ifnotequal</code> 。</p><h4 id="模板标签"><a class="anchor" href="#模板标签">#</a> 模板：标签</h4><p>Django 模板内置标签：</p><ul><li><code>&#123;.% for %&#125;</code> 与 <code>&#123;.% endfor %&#125;</code> ：遍历输出内容。</li><li><code>&#123;.% if %&#125;</code> 、 <code>&#123;.% elif %&#125;</code> 及 <code>&#123;.% endif %&#125;</code> ：条件判断。</li><li><code>&#123;.% url name args %&#125;</code> ：引用路由配置名。</li><li><code>&#123;.% load %&#125;</code> ：加载 Django 标签库。</li><li><code>&#123;.% load static %&#125;</code> ：</li><li><code>&#123;.% static static_path %&#125;</code> ：读取静态资源。</li><li><code>&#123;.% extends base_template %&#125;</code> ：模板继承。</li><li><code>&#123;.% block data %&#125;</code> 与 <code>&#123;.% endblock %&#125;</code> ：重写父模板代码。</li><li><code>&#123;.% csrf_token %&#125;</code> ：跨域密钥。</li></ul><h4 id="静态资源"><a class="anchor" href="#静态资源">#</a> 静态资源</h4><p>使用静态资源之前，需要在 <span class="exturl" data-url="aHR0cDovL3NldHRpbmdzLnB5">settings.py</span> 中进行配置：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 指定静态文件位置</span></pre></td></tr><tr><td data-num="2"></td><td><pre>STATICFILES_DIRS <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'static'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>模板中使用：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>&#123;.%% load static files %&#125;</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;.% static <span class="token punctuation">'</span>images/test.jpg<span class="token punctuation">'</span> %&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></pre></td></tr></table></figure><h4 id="自定义标签"><a class="anchor" href="#自定义标签">#</a> 自定义标签</h4><p>自定义标签步骤：</p><ol><li><p>应用目录下创建 templatetags 目录。</p></li><li><p>在 templatetags 目录下创建任意文件，如 <code>my_tags.py</code> 。</p></li><li><p>配置文件中指定配置。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>TEMPLATES <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token string">'BACKEND'</span><span class="token punctuation">:</span> <span class="token string">'django.template.backends.django.DjangoTemplates'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token string">'DIRS'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">,</span> <span class="token string">'templates'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  <span class="token comment"># 指定模板文件位置：当前项目下的 templates 文件夹</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token string">'APP_DIRS'</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token string">'OPTIONS'</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>            <span class="token string">'context_processors'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="8"></td><td><pre>                <span class="token string">'django.template.context_processors.debug'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>                <span class="token string">'django.template.context_processors.request'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>                <span class="token string">'django.contrib.auth.context_processors.auth'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>                <span class="token string">'django.contrib.messages.context_processors.messages'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token punctuation">]</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            <span class="token string">"libraries"</span><span class="token punctuation">:</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>                <span class="token string">'my_tags'</span><span class="token punctuation">:</span> <span class="token string">'app.templatetags.my_tags'</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure></li><li><p>编辑 my_tags.py</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/templatetags/my_tags.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django <span class="token keyword">import</span> template</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>register <span class="token operator">=</span> template<span class="token punctuation">.</span>Library<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token decorator annotation punctuation">@register<span class="token punctuation">.</span>simple_tag</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'mytag'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">def</span> <span class="token function">my_tag1</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> v1 <span class="token operator">*</span> v2 <span class="token operator">*</span> v3</pre></td></tr></table></figure></li><li><p>在模板文件中使用</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre>&#123;.% load my_tags %&#125;</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>11 * 22 * 33 = &#123;.% mytag 11 22 33 %&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr></table></figure></li></ol><p>此外，自定义标签时，也可以对标签内容进行语义化处理：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/templatetags/my_tags.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django <span class="token keyword">import</span> template</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>safestring <span class="token keyword">import</span> mark_safe</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>register <span class="token operator">=</span> template<span class="token punctuation">.</span>Library<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token decorator annotation punctuation">@register<span class="token punctuation">.</span>simple_tag</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">def</span> <span class="token function">my_html</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    temp_html <span class="token operator">=</span> <span class="token string">"&lt;input type='text' id='%s' placeholder='%s' />"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">return</span> mark_safe<span class="token punctuation">(</span>temp_html<span class="token punctuation">)</span></pre></td></tr></table></figure><p>在模板文件中使用：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>mydjango<span class="token operator">/</span>templates<span class="token operator">/</span>index<span class="token punctuation">.</span>html<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token operator">%</span> load my_tags <span class="token operator">%</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token operator">%</span> my_html <span class="token number">20</span> <span class="token string">'请输入年龄'</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr></table></figure><h4 id="其他模板知识"><a class="anchor" href="#其他模板知识">#</a> 其他模板知识</h4><ol><li><p>注释</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr></table></figure></li><li><p>include 标签</p><p>include 标签允许在模板之中包含其他模板：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre>&#123;.% include "nav.html" %&#125;</pre></td></tr></table></figure></li><li><p>csrf_token</p><p><code>csrf_token</code> 用于 form 表单中，作用是跨站请求伪造保护，使用这个标签，表单提交数据才会成功，否则进行再次跳转页面时会抛出 403 错误。</p></li><li><p>其他模板如 <code>jinja2</code> 、 <code>mako</code> 等，了解即可，如有需求，自行摸索。</p></li></ol><h3 id="django-模型"><a class="anchor" href="#django-模型">#</a> Django 模型</h3><p>Django 对各种数据库提供了很好的支持，包括：PostgreSQL、MySQL、SQLite、Oracle，本文将以 MySQL 作为示例进行学习。</p><p>安装 python mysql 驱动：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>pip3 <span class="token function">install</span> pymysql -i https://pypi.douban.com/simple</pre></td></tr></table></figure><h4 id="数据库配置"><a class="anchor" href="#数据库配置">#</a> 数据库配置</h4><p>手动创建数据库：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">create</span> <span class="token keyword">database</span> mydjango <span class="token keyword">default</span> <span class="token keyword">charset</span><span class="token operator">=</span>utf8<span class="token punctuation">;</span></pre></td></tr></table></figure><p>配置数据库信息：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/settings.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre>DATABASES <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token string">'default'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token string">'ENGINE'</span><span class="token punctuation">:</span> <span class="token string">'django.db.backends.mysql'</span><span class="token punctuation">,</span>  <span class="token comment"># 数据库引擎</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token string">'NAME'</span><span class="token punctuation">:</span> <span class="token string">'mydjango'</span><span class="token punctuation">,</span>  <span class="token comment"># 数据库名称</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token string">'HOST'</span><span class="token punctuation">:</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span>  <span class="token comment"># 数据库地址，本机 ip 地址 127.0.0.1</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token string">'PORT'</span><span class="token punctuation">:</span> <span class="token number">3306</span><span class="token punctuation">,</span>  <span class="token comment"># 端口</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token string">'USER'</span><span class="token punctuation">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>   <span class="token comment"># 数据库用户名</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token string">'PASSWORD'</span><span class="token punctuation">:</span> <span class="token string">'123456'</span><span class="token punctuation">,</span>  <span class="token comment"># 数据库密码</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>在 <span class="exturl" data-url="aHR0cDovL3NldHRpbmdzLnB5">settings.py</span> 同级目录下的 <code>__init__.py</code> 中编辑内容：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/__init__.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> pymysql</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>pymysql<span class="token punctuation">.</span>install_as_MySQLdb<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="定义模型"><a class="anchor" href="#定义模型">#</a> 定义模型</h4><p>编辑模型文件：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/models.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>创建表结构：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>python3 manage.py migrate <span class="token comment"># 创建表结构</span></pre></td></tr><tr><td data-num="2"></td><td><pre>python3 manage.py makemigrations</pre></td></tr><tr><td data-num="3"></td><td><pre>python3 manage.py migrate</pre></td></tr></table></figure><p>执行成功后，就会自动向数据库创建一张表 <code>app_test</code> （表名与当前模块和模型内的类名有关）。</p><blockquote><p>提示：</p><ol><li><p>如需在 PyCharm Terminal 中自动激活虚拟环境，可在 settings -&gt; Tools -&gt; Terminal -&gt; Shell path 中进行类似如下的配置：</p><p><code>&quot;cmd.exe&quot; /k &quot;&quot;A:\python-venv\django_venv\Scripts\activate&quot;&quot;</code></p></li><li><p>执行 <code>python3 manage.py migrate</code> 时报错：'str' object has no attribute 'decode'</p><p><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L29uZV9kYXk0MTUvYXJ0aWNsZS9kZXRhaWxzLzEwMTIzMjk2Mg==">点击此处</span>前往查看解决方法。</p></li></ol></blockquote><h4 id="数据库操作"><a class="anchor" href="#数据库操作">#</a> 数据库操作</h4><p>配置路由：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'user/add/&lt;str:name>'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>UserAdd<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>视图处理：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> app<span class="token punctuation">.</span>models <span class="token keyword">import</span> Test</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">UserAdd</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    test1 <span class="token operator">=</span> Test<span class="token punctuation">(</span>name<span class="token operator">=</span>name<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    test1<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"&lt;p>数据添加成功！&lt;/p>"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>浏览器访问 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTo4MDAwL3VzZXIvYWRkL3poYW5n">http://127.0.0.1:8000/user/add/zhang</span> 即可向数据库添加一条记录，且其主键默认采用自增策略。</p><p>类似地，通过对象直接调用方法，即可完成对数据库的增删改查：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 查询所有，相当于 => select *</span></pre></td></tr><tr><td data-num="3"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 过滤查询，相当于 => where</span></pre></td></tr><tr><td data-num="4"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># 查询单个对象</span></pre></td></tr><tr><td data-num="5"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>  <span class="token comment"># 排序并限制，相当于 => order by 'name' offset 0 limit 2</span></pre></td></tr><tr><td data-num="6"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>  <span class="token comment"># 排序</span></pre></td></tr><tr><td data-num="7"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"runoob"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span>  <span class="token comment"># 连锁使用</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 更新数据</span></pre></td></tr><tr><td data-num="9"></td><td><pre>test1 <span class="token operator">=</span> Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>test1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Ouyang'</span></pre></td></tr><tr><td data-num="11"></td><td><pre>test1<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Ouyang'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>update<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'Xxx'</span><span class="token punctuation">)</span>  <span class="token comment"># 修改所有</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment"># 删除数据</span></pre></td></tr><tr><td data-num="15"></td><td><pre>test2 <span class="token operator">=</span> Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>test2<span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>Test<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 删除所有</span></pre></td></tr></table></figure><h3 id="django-表单"><a class="anchor" href="#django-表单">#</a> Django 表单</h3><h4 id="get"><a class="anchor" href="#get">#</a> GET</h4><p>创建模板文件：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>mydjango<span class="token operator">/</span>templates<span class="token operator">/</span>search_form<span class="token punctuation">.</span>html<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>!DOCTYPE html<span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">&lt;</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token operator">&lt;</span>title<span class="token operator">></span>Django form get<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">&lt;</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">"/search/"</span> method<span class="token operator">=</span><span class="token string">"get"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"q"</span> placeholder<span class="token operator">=</span><span class="token string">"请输入搜索内容"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"submit"</span> value<span class="token operator">=</span><span class="token string">"搜索"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></pre></td></tr></table></figure><p>编辑视图文件：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 表单</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">search_form</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'search_form.html'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 接收请求数据</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">def</span> <span class="token function">search</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    request<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">'utf-8'</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">if</span> <span class="token string">'q'</span> <span class="token keyword">in</span> request<span class="token punctuation">.</span>GET <span class="token keyword">and</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">[</span><span class="token string">'q'</span><span class="token punctuation">]</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        message <span class="token operator">=</span> <span class="token string">'你搜索的内容为: '</span> <span class="token operator">+</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">[</span><span class="token string">'q'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        message <span class="token operator">=</span> <span class="token string">'你提交了空表单'</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>message<span class="token punctuation">)</span></pre></td></tr></table></figure><p>配置路由：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    url<span class="token punctuation">(</span><span class="token string">r'^search-form/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>search_form<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    url<span class="token punctuation">(</span><span class="token string">r'^search/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>search<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><h4 id="post"><a class="anchor" href="#post">#</a> Post</h4><p>创建模板文件：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Django form post<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/search-post/<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>    &#123;.% csrf_token %&#125;<span class="token comment"></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>q<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>请输入搜索内容<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>搜索<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>&#123;.&#123; keyword &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>编辑视图文件：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">search_post</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    ctx <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        ctx<span class="token punctuation">[</span><span class="token string">'keyword'</span><span class="token punctuation">]</span> <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">[</span><span class="token string">'q'</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"post.html"</span><span class="token punctuation">,</span> ctx<span class="token punctuation">)</span></pre></td></tr></table></figure><p>配置路由：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    url<span class="token punctuation">(</span><span class="token string">r'^search-post/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>search_post<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>通过这种方式，可以将提交的数据处理后，重新渲染到页面上。</p><h4 id="request-对象"><a class="anchor" href="#request-对象">#</a> Request 对象</h4><p>每个视图函数的第一个参数都必须是 <code>HttpRequest</code> 对象，通过该对象，可以获取一些列属性：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">def</span> <span class="token function">dj_test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>path<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"Hello world!"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>request 中的属性主要有：</p><ol><li>path</li><li>method</li><li>GET</li><li>POST</li><li>REQUEST：为了方便，该属性是 POST 和 GET 属性的集合体，但是有特殊性，先查找 POST 属性，然后再查找 GET 属性。（不建议使用）</li><li>COOKIES</li><li>FILES</li><li>META：包含所有可用 HTTP 头部信息的字典。</li><li>user：是一个 <code>django.contrib.auth.models.User</code> 对象，代表当前登录的用户。可以通过 user 的 <code>is_authenticated()</code> 方法来辨别用户是否登录。</li><li>session</li><li>raw_post_data：原始 HTTP POST 数据，未解析过。高级处理时会有用处。</li></ol><p>request 也提供了一些方法：</p><ol><li><code>__getitem__(key)</code> ：返回 GET/POST 的键值，先取 POST，后取 GET。如果键不存在则抛出 KeyError。</li><li><code>has_key()</code> ：检查 request.GET or request.POST 中是否包含参数指定的 Key。</li><li><code>get_full_path()</code></li><li><code>is_secure()</code> ：检验 HTTPS。</li></ol><h4 id="querydict-对象"><a class="anchor" href="#querydict-对象">#</a> QueryDict 对象</h4><p>在 HttpRequest 对象中，GET 和 POST 属性是 django.http.QueryDict 类的实例。QueryDict 类似字典的自定义类，用来处理单键对应多值的情况，它不仅实现所有标准的词典方法，还包括了一些特有的方法：</p><ol><li><p><code>__getitem__(key)</code> ：和标准字典的处理有一点不同，就是，如果 Key 对应多个 Value，则会返回最后一个 value。</p></li><li><p><code>__setitem__(key, value)</code> ：这里的 value 是一个 list，它只能在一个 mutable QueryDict 对象上被调用（即通过 copy 产生的一个 QueryDict 对象的拷贝）。</p></li><li><p><code>get()</code> ：如果对应多个 value，则返回最后一个。</p></li><li><p><code>update()</code> ：参数可以是 QueryDict，也可以是标准字典。和标准字典的 update 方法不同，该方法添加字典 items，而不是替换它们。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>q <span class="token operator">=</span> QueryDict<span class="token punctuation">(</span><span class="token string">'a=1'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>q <span class="token operator">=</span> q<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># to make it mutable</span></pre></td></tr><tr><td data-num="3"></td><td><pre>q<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'a'</span><span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>getlist<span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># ['1', '2']</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># ['2'] # return the last one</span></pre></td></tr></table></figure></li><li><p><code>items()</code> ：和标准字典同名方法有一点不同，该方法使用单值逻辑的 <em>_getitem</em>_()。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>q <span class="token operator">=</span> QueryDict<span class="token punctuation">(</span><span class="token string">'a=1&amp;a=2&amp;a=3'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>q<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># [('a', '3')]</span></pre></td></tr></table></figure></li><li><p><code>values()</code> ：同样是单值。</p></li><li><p>copy</p></li><li><p>getlist</p></li><li><p>setlist</p></li><li><p>appendlist</p></li><li><p>setlistdefault</p></li><li><p>lists</p></li><li><p>urlencode</p></li></ol><h3 id="django-视图"><a class="anchor" href="#django-视图">#</a> Django 视图</h3><p>一个视图函数，简称视图，是一个简单的 Python 函数，它接受 Web 请求并且返回 Web 响应。响应可以是一个 HTML 页面、一个 404 错误页面、重定向页面、XML 文档、或者一张图片等。视图逻辑一般放在项目的 <span class="exturl" data-url="aHR0cDovL3ZpZXdzLnB5">views.py</span> 文件中，但并不限制。</p><p>视图响应方式包括：HttpResponse、render、redirect。</p><h4 id="httpresponse"><a class="anchor" href="#httpresponse">#</a> HttpResponse</h4><p>返回字符串文本，包括 html 形式的字符串在内。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">def</span> <span class="token function">http_response_text</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'Hello world!'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">http_response_html</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'&lt;a href="https://www.chinmoku.cc">チンモクのブログ&lt;/>'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p>HttpResponse 返回 html 代码时，代码内容由模板进行渲染处理。</p></blockquote><h4 id="render"><a class="anchor" href="#render">#</a> render</h4><p>返回文本，第二个参数为模板页面名称，第三个参数为字典（可选）。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">def</span> <span class="token function">Home</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> age<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> name<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token string">'age'</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"home.html"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span></pre></td></tr></table></figure><p>render 底层返回的也是 HttpResponse 对象。</p><h4 id="redirect"><a class="anchor" href="#redirect">#</a> redirect</h4><p>重定向，跳转新页面。参数为字符串，字符串中填写页面路径。一般用于 form 表单提交后，跳转到新页面。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> redirect</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">def</span> <span class="token function">to_index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/index/'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>redirect 底层继承自 HttpResponse。</p><h4 id="jsonresponse"><a class="anchor" href="#jsonresponse">#</a> JsonResponse</h4><p>JsonResponse 返回标准 JSON，与 HttpResponse 不同的是，JsonResponse 无需手动进行序列化与反序列化。HttpResponse 字符串 JSON 则需要对序列化和反序列化手动进行处理。</p><h3 id="django-路由"><a class="anchor" href="#django-路由">#</a> Django 路由</h3><p>路由简单的来说就是根据用户请求的 URL 链接来判断对应的处理程序，并返回处理结果，也就是 URL 与 Django 的视图建立映射关系。Django 路由在 <span class="exturl" data-url="aHR0cDovL3VybHMucHk=">urls.py</span> 配置，<span class="exturl" data-url="aHR0cDovL3VybHMucHk=">urls.py</span> 中的每一条配置对应相应的处理方法。</p><h4 id="路由配置方式"><a class="anchor" href="#路由配置方式">#</a> 路由配置方式</h4><ol><li><p>Django 1.1.x</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url <span class="token comment"># 用 url 需要引入</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    url<span class="token punctuation">(</span><span class="token string">r'^admin/$'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    url<span class="token punctuation">(</span><span class="token string">r'^index/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 普通路径</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    url<span class="token punctuation">(</span><span class="token string">r'^articles/([0-9]&#123;4&#125;)/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Articles<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 正则路径</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure></li><li><p>Django 2.2.x+</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> re_path <span class="token comment"># 用 re_path 需要引入</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'index/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 普通路径</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    re_path<span class="token punctuation">(</span><span class="token string">r'^articles/([0-9]&#123;4&#125;)/$'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>articles<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment"># 正则路径（版本向下兼容，也可以使用 url ()）</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><ul><li>path：用于普通路径，不需要自己手动添加正则首位限制符号，底层已经添加。</li><li>re_path：用于正则路径，需要自己手动添加正则首位限制符号。</li></ul></li></ol><h4 id="正则路由"><a class="anchor" href="#正则路由">#</a> 正则路由</h4><ol><li><p>正则路径中的无名分组</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> re_path</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'home/&lt;str:name>/&lt;int:age>'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Home<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    re_path<span class="token punctuation">(</span><span class="token string">r"^index/(?P&lt;age>[0-9]&#123;2&#125;)/(?P&lt;name>[A-Z]&#123;2&#125;)/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Home<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>视图处理：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">Articles</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> year<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>year<span class="token punctuation">)</span>  <span class="token comment"># 一个形参代表路径中一个分组的内容，按顺序匹配</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    articleId <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'articleId'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>  <span class="token comment"># 获取非路径参数的 get 参数</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>articleId<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token comment"># ... 处理逻辑</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'Django tutorial!'</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>正则路径中的有名分组</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> re_path</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'home/&lt;str:name>/&lt;int:age>'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Home<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    re_path<span class="token punctuation">(</span><span class="token string">r"^home2/(?P&lt;age>[0-9]&#123;2&#125;)/(?P&lt;name>[A-Z]&#123;2&#125;)/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Home<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>视图处理：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">Home</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> age<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'name'</span><span class="token punctuation">:</span> name<span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> age<span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"home.html"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span></pre></td></tr></table></figure><p>有名分组会在路由中指定参数名称，视图解析时则不需要按照规定顺序，只需要根据名称进行匹配即可。</p></li><li><p>路由分发</p><p>Django 项目中多个 app 共用一个 <span class="exturl" data-url="aHR0cDovL3VybHMucHk=">urls.py</span> 容易造成混淆，因此，每个 app 可以拥有自己的 <span class="exturl" data-url="aHR0cDovL3VybHMucHk=">urls.py</span> 文件配置路由。</p><p>而在项目路由中，只需要通过如下方式配置路由分发即可：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> include</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token string">'app.urls'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure></li></ol><h4 id="反向解析"><a class="anchor" href="#反向解析">#</a> 反向解析</h4><p>在路由配置中，指定路由的 <code>name</code> 属性，即可设置反向解析的参考点，例如：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'index/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Index<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'search-form/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Index<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'toForm'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>在模板中使用：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">&lt;!-- mydjango/templates/index.html --></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;.% url <span class="token punctuation">'</span>toForm<span class="token punctuation">'</span> %&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>填写信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>点击链接即可将请求发送到 views.Index 进行处理。</p><p>在视图中使用：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> redirect</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">redirectForm</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token string">'toForm'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>当某一请求调用执行 redirectForm 时，就会重定向到 views.Index 进行后续处理。</p><p>在反向解析路由时，同样可以传递参数，包括有名和无名分组在内，传递参数方式如下：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;.% url <span class="token punctuation">'</span>toForm<span class="token punctuation">'</span> 19 %&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>填写信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;.% url <span class="token punctuation">'</span>toForm<span class="token punctuation">'</span> age=19 %&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>填写信息<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><p>在视图中反向解析时传递参数：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> redirect</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">redirectForm</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token string">'toForm'</span><span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 无名分组</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token comment"># return redirect (reversed ('toForm', kwargs=&#123;'age': 19&#125;))  # 无名分组</span></pre></td></tr></table></figure><blockquote><p>路由别名 name 没有作用域，Django 在反向解析 URL 时，会在项目全局顺序搜索，当查找到第一个路由别名 name 指定 URL 时，立即返回。当在不同的 app 目录下的 urls 中定义相同的路由别名 name 时，可能会导致 URL 反向解析错误。</p></blockquote><h4 id="命名空间"><a class="anchor" href="#命名空间">#</a> 命名空间</h4><p>命名空间是表示标识符的可见范围。</p><ul><li>一个标识符可在多个命名空间中定义，它在不同命名空间中的含义是互不相干的。</li><li>一个新的命名空间中可定义任何标识符，它们不会与任何重复的标识符发生冲突，因为重复的定义都处于其它命名空间中。</li></ul><p>由于路由别名没有作用于，因此多个 app 存在同名别名时，会导致反向解析错误，但如果对其限定命名空间，就可以避免该错误。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path<span class="token punctuation">,</span> include</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> include<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'app.urls'</span><span class="token punctuation">,</span> <span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>在子路由中指定反向解析别名：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'search-form/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Index<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'toForm'</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>此时使用如下方式进行路由反向解析，则只会在命名空间指定的 app 下查找路由：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> redirect</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">redirectForm</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token builtin">reversed</span><span class="token punctuation">(</span><span class="token string">'app:toForm'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>在模板中的使用方式也是类似：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span>swig￼<span class="token number">12</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"&#123;.% url 'app:toForm' 19 %&#125;"</span><span class="token operator">></span>填写信息<span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr></table></figure><h3 id="django-admin"><a class="anchor" href="#django-admin">#</a> Django Admin</h3><h4 id="配置"><a class="anchor" href="#配置">#</a> 配置</h4><p>Django 提供了基于 web 的管理工具。Django 自动管理工具是 django.contrib 的一部分。Django Admin 默认情况下即被注册启用：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/settings.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre>INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token string">'django.contrib.admin'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token string">'django.contrib.auth'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token string">'django.contrib.contenttypes'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token string">'django.contrib.sessions'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token string">'django.contrib.messages'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token string">'django.contrib.staticfiles'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>如需使用，只需在路由中进行指定即可（通常创建项目时默认即指定了）：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>conf<span class="token punctuation">.</span>urls <span class="token keyword">import</span> url</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    url<span class="token punctuation">(</span><span class="token string">r'^admin/'</span><span class="token punctuation">,</span> admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>urls<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>通过访问 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTo4MDAwL2FkbWluLw==">http://127.0.0.1:8000/admin/</span> 即可跳转登录界面。</p><h4 id="登录与使用"><a class="anchor" href="#登录与使用">#</a> 登录与使用</h4><p>可以通过命令 <code>python3 manage.py createsuperuser</code> 来创建超级用户，创建成功后，即可登录，登录成功后将跳转如下页面：</p><p><img data-src="https://img.xfc-exclave.com/2021/10/08daa75223cafee969ae81742a4186b61635348370.png" alt="image-20211027232541350"></p><p>如需在 admin 界面管理某个数据模型，只需要在应用下的 <span class="exturl" data-url="aHR0cDovL2FkbWluLnB5">admin.py</span> 文件中注册对应的数据模型即可：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> admin</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> app<span class="token punctuation">.</span>models <span class="token keyword">import</span> Test</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># Register your models here.</span></pre></td></tr><tr><td data-num="5"></td><td><pre>admin<span class="token punctuation">.</span>site<span class="token punctuation">.</span>register<span class="token punctuation">(</span>Test<span class="token punctuation">)</span></pre></td></tr></table></figure><p>然后刷新 admin 界面，即可看到对应的数据模型。</p><h4 id="自定义表单"><a class="anchor" href="#自定义表单">#</a> 自定义表单</h4><blockquote><p>自行摸索吧，感觉没啥意思。</p></blockquote><h3 id="django-orm"><a class="anchor" href="#django-orm">#</a> Django ORM</h3><h4 id="单表实例"><a class="anchor" href="#单表实例">#</a> 单表实例</h4><ol><li><p>准备工作</p><p>注册当前应用：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/settings.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre>INSTALLED_APPS <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token string">'django.contrib.admin'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token string">'django.contrib.auth'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token string">'django.contrib.contenttypes'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token string">'django.contrib.sessions'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token string">'django.contrib.messages'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token string">'django.contrib.staticfiles'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token string">'app01'</span><span class="token punctuation">,</span>  <span class="token comment"># 添加此项</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><p>指定数据库连接：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/__init__.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> pymysql</pre></td></tr><tr><td data-num="3"></td><td><pre>pymysql<span class="token punctuation">.</span>install_as_MySQLdb<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>创建模型</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/models.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token builtin">id</span> <span class="token operator">=</span> models<span class="token punctuation">.</span>AutoField<span class="token punctuation">(</span>primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># id 会自动创建，可以手动写入</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>  <span class="token comment"># 书籍名称</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    price <span class="token operator">=</span> models<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token comment"># 书籍价格</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    publish <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span>  <span class="token comment"># 出版社名称</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    pub_date <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 出版时间</span></pre></td></tr></table></figure><p>执行数据迁移命令：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>python3 manage.py migrate  <span class="token comment"># 创建表结构</span></pre></td></tr><tr><td data-num="2"></td><td><pre>python3 manage.py makemigrations app  <span class="token comment"># 让 Django 知道我们在我们的模型有一些变更</span></pre></td></tr><tr><td data-num="3"></td><td><pre>python3 manage.py migrate app  <span class="token comment"># 创建表结构</span></pre></td></tr></table></figure><p>执行完毕后，数据库会生成一张 <code>app_book</code> 表。</p></li><li><p>新增数据</p><p>编写新增数据的视图函数：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> app <span class="token keyword">import</span> models</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">def</span> <span class="token function">add_book</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    book <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"捕鱼女"</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">35.00</span><span class="token punctuation">,</span> publish<span class="token operator">=</span><span class="token string">"江苏凤凰文艺出版社"</span><span class="token punctuation">,</span> pub_date<span class="token operator">=</span><span class="token string">"2015-10-01"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'&lt;p>&lt;script>alert("数据添加成功！")&lt;/script>&lt;/p>'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>配置路由规则：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/urls.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>urls <span class="token keyword">import</span> path</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> <span class="token punctuation">.</span> <span class="token keyword">import</span> views</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">'book/add/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>add_book<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><p>浏览器访问 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTo4MDAw">http://127.0.0.1:8000</span> 即可在向数据库中新增一条记录。</p><p>此外，也可以使用如下方式新增数据：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>books <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"日本文学史"</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">48.00</span><span class="token punctuation">,</span> publish<span class="token operator">=</span><span class="token string">"译林出版社"</span><span class="token punctuation">,</span> pub_date<span class="token operator">=</span><span class="token string">"2020-06-01"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>books<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># Book object (4)</span></pre></td></tr></table></figure></li><li><p>查询数据</p><ul><li><p>查询列表</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_books</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    books <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>books<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># QuerySet 类型</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'&lt;p>&lt;script>alert("数据列表查询成功！")&lt;/script>&lt;/p>'</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>过滤查询</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">get_book</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> book_id<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    books <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span>book_id<span class="token punctuation">)</span>  <span class="token comment"># 这里 pk 相当于 primary key，因为 id 有其他特殊意义所以使用 pk 替代 id</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment"># books = models.Book.objects.filter(price__lt=40.00)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment"># books = models.Book.objects.filter (title__iendswith=' 文学史 ')</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>books<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>books<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># QuerySet 类型</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">for</span> book <span class="token keyword">in</span> books<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>book<span class="token punctuation">.</span>title<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'&lt;p>&lt;script>alert("数据列表过滤查询成功！")&lt;/script>&lt;/p>'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>filter 也内置了一些其他常用的筛选方式，通过如下提示即可查看：</p><p><img data-src="https://img.xfc-exclave.com/2021/11/51fe7dd6bd601bbe7f2d413faa24f0dc1635813491.png" alt="image-20211101204130217"></p><p>关于过滤规则及其意义，可以<span class="exturl" data-url="aHR0cHM6Ly93d3cuamI1MS5uZXQvYXJ0aWNsZS8xODI3NjcuaHRt">点击此处</span>作为参考，这里不反复书写示例。</p><blockquote><p>filter 中只能使用 <code>=</code> ，无法使用大于小于等其他比较符号。但是，可以使用 <code>__gt</code> 这样的方式来间接表示。</p></blockquote></li><li><p>反向查询</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询不符合条件（pk=book_id）的所有数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre>books <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>exclude<span class="token punctuation">(</span>pk<span class="token operator">=</span>book_id<span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>单条查询</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>book <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>book_id<span class="token punctuation">)</span></pre></td></tr></table></figure><p>单条查询的查询条件不一定是主键，但必须保证查询结果是单一的，否则会抛出异常。</p></li><li><p>排序</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>books <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>price__lt<span class="token operator">=</span><span class="token number">40.00</span><span class="token punctuation">)</span><span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span>  <span class="token comment"># 升序</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># books = models.Book.objects.filter (price__lt=40.00).order_by ('-title')  # 降序（在条件前添加负号 “-” 即可）</span></pre></td></tr></table></figure></li><li><p>排序翻转</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>books <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>price__lt<span class="token operator">=</span><span class="token number">40.00</span><span class="token punctuation">)</span><span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">'title'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reverse<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 将原本的排序进行翻转</span></pre></td></tr></table></figure></li><li><p>计数</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>count <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>price__gt<span class="token operator">=</span><span class="token number">40.00</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># int 类型</span></pre></td></tr></table></figure></li><li><p>查询第一条</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>books <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 返回所有数据的第一条数据</span></pre></td></tr></table></figure><p>其实就是在所有查询的数据列表中，取下标为 0 的数据。</p></li><li><p>查询最后一条（同上）</p></li><li><p>仅查询指定的字段</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>book_vals <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token string">'pk'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>book_vals<span class="token punctuation">)</span>  <span class="token comment"># QuerySet 内部是可迭代的字典序列</span></pre></td></tr><tr><td data-num="3"></td><td><pre>book_val_list <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>values_list<span class="token punctuation">(</span><span class="token string">'pk'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>book_val_list<span class="token punctuation">)</span>  <span class="token comment"># QuerySet 内部是元组</span></pre></td></tr></table></figure></li><li><p>去重复</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>books <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>values_list<span class="token punctuation">(</span><span class="token string">"publish"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li></ul></li><li><p>修改数据</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">update_book</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> book_id<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    book <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>book_id<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    book<span class="token punctuation">.</span>price <span class="token operator">=</span> <span class="token number">40.00</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    book<span class="token punctuation">.</span>save<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment"># books = models.Book.objects.filter(pk__in=[7, 8]).update(price=35.00)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'&lt;p>&lt;script>alert("数据更新成功！")&lt;/script>&lt;/p>'</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>删除数据</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>books<span class="token operator">=</span>models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>delete<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># books = models.Book.objects.all ().delete ()  # 删除所有</span></pre></td></tr></table></figure><blockquote><p>注意：数据删除属于非常规操作，在业务过程中，一般删除都进行逻辑删除，而非物理删除。</p></blockquote></li></ol><h4 id="多表实例"><a class="anchor" href="#多表实例">#</a> 多表实例</h4><p>表与表之间的关系，通常有如下三种：</p><ol><li>一对一。</li><li>一对多。</li><li>多对多。</li></ol><blockquote><p>注意：这种对应关系时相对而言的，若甲与乙是一对多关系，那么，乙与甲则是一对一关系（也可以说是多对一），反之，则不一定成立。</p></blockquote><ol><li><p>准备工作</p><ul><li><p>移除上一实例生成的数据库表，以及删除对应的数据模型，或者重新新建应用。</p></li><li><p>清除 mydjango/app/migrations 下的 sql 脚本文件。</p></li><li><p>删除数据库表 <code>django_migrations</code> 中旧有生成记录。</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">delete</span> <span class="token keyword">from</span> django_migrations <span class="token keyword">where</span> app <span class="token operator">=</span> <span class="token string">'app'</span></pre></td></tr></table></figure></li></ul></li><li><p>创建模型</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/models.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>db <span class="token keyword">import</span> models</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Book</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    price <span class="token operator">=</span> models<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    pub_date <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    publish <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span><span class="token string">"Publish"</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    authors <span class="token operator">=</span> models<span class="token punctuation">.</span>ManyToManyField<span class="token punctuation">(</span><span class="token string">"Author"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Publish</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    city <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    email <span class="token operator">=</span> models<span class="token punctuation">.</span>EmailField<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Author</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    name <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    age <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    au_detail <span class="token operator">=</span> models<span class="token punctuation">.</span>OneToOneField<span class="token punctuation">(</span><span class="token string">"AuthorDetail"</span><span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">AuthorDetail</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    gender_choices <span class="token operator">=</span> <span class="token punctuation">(</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"女"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"男"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"未知"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    gender <span class="token operator">=</span> models<span class="token punctuation">.</span>SmallIntegerField<span class="token punctuation">(</span>choices<span class="token operator">=</span>gender_choices<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    phone <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">32</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    address <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    birthday <span class="token operator">=</span> models<span class="token punctuation">.</span>DateField<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p>说明：</p><ol><li>EmailField 数据类型是邮箱格式，底层继承 CharField，进行了封装，相当于 MySQL 中的 varchar。</li><li>Django1.1 版本不需要联级删除：on_delete=models.CASCADE，Django2.2 需要。</li></ol></blockquote><p>执行数据迁移命令：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>python3 manage.py migrate</pre></td></tr><tr><td data-num="2"></td><td><pre>python3 manage.py makemigrations app</pre></td></tr><tr><td data-num="3"></td><td><pre>python3 manage.py migrate app</pre></td></tr></table></figure><p>执行完毕后，数据库会生成如下表结构：</p><p><img data-src="https://img.xfc-exclave.com/2021/11/feb0ba77917d6af9622e1675fe5e21da1635813491.png" alt="image-20211102081211144"></p></li><li><p>初始化数据</p><p>为方便后续操作，为当前生成的表结构初始化部分数据：</p><figure class="highlight sql"><figcaption data-lang="SQL"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> app_publish<span class="token punctuation">(</span>name<span class="token punctuation">,</span> city<span class="token punctuation">,</span> email<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">"山东文艺出版社"</span><span class="token punctuation">,</span> <span class="token string">"山东"</span><span class="token punctuation">,</span> <span class="token string">"602666251@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"商务印书馆"</span><span class="token punctuation">,</span> <span class="token string">"北京"</span><span class="token punctuation">,</span> <span class="token string">"bainianziyuan@cp.com.cn"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"时代文艺出版社"</span><span class="token punctuation">,</span> <span class="token string">"吉林"</span><span class="token punctuation">,</span> <span class="token string">"367036063@qq.com"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"花城出版社"</span><span class="token punctuation">,</span> <span class="token string">"广东"</span><span class="token punctuation">,</span> <span class="token string">"gdhctsyx@126.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> app_book<span class="token punctuation">(</span>title<span class="token punctuation">,</span> price<span class="token punctuation">,</span> pub_date<span class="token punctuation">,</span> publish_id<span class="token punctuation">)</span> <span class="token keyword">values</span><span class="token punctuation">(</span><span class="token string">'深处的镜子'</span><span class="token punctuation">,</span> <span class="token number">42.00</span><span class="token punctuation">,</span> <span class="token string">'2018-08-01'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'诗学'</span><span class="token punctuation">,</span> <span class="token number">36.00</span><span class="token punctuation">,</span> <span class="token string">'2009-07-01'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'神殿的基石'</span><span class="token punctuation">,</span> <span class="token number">38.00</span><span class="token punctuation">,</span> <span class="token string">'2014-04-01'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> app_authordetail<span class="token punctuation">(</span>gender<span class="token punctuation">,</span> phone<span class="token punctuation">,</span> address<span class="token punctuation">,</span> birthday<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13432335433</span><span class="token punctuation">,</span> <span class="token string">"罗马尼亚"</span><span class="token punctuation">,</span> <span class="token string">"1895-5-23"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">13943454554</span><span class="token punctuation">,</span> <span class="token string">"古希腊"</span><span class="token punctuation">,</span> <span class="token string">"1000-8-13"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> app_author<span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> au_detail_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token string">"卢齐安·布拉加"</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">"亚里士多德"</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">insert</span> <span class="token keyword">into</span> app_book_authors<span class="token punctuation">(</span>book_id<span class="token punctuation">,</span> author_id<span class="token punctuation">)</span> <span class="token keyword">values</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr></table></figure><blockquote><p>注意：由于表之间存在外键关联关系，因此，在手动插入数据时，需要遵循关联顺序进行插入。</p></blockquote></li><li><p>新增数据</p><p>一对多添加数据：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">addBook</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    pub_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    book <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"一九八四"</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">32.00</span><span class="token punctuation">,</span> pub_date<span class="token operator">=</span><span class="token string">"2021-01-01"</span><span class="token punctuation">,</span> publish<span class="token operator">=</span>pub_obj<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment"># book = models.Book.objects.create (title="先知・沙与沫", price=35.00, pub_date="2018-07-01", publish_id=pub_obj.pk)  # 方法二</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>book<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>book<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>book<span class="token punctuation">)</span></pre></td></tr></table></figure><p>多对多添加数据：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">addBook</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token comment">#  获取书籍对象</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    book1 <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"神殿的基石"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    book2 <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"深处的镜子"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment">#  获取作者对象</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    author <span class="token operator">=</span> models<span class="token punctuation">.</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"卢齐安·布拉加"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">#  给作者对象的 book_set 属性用 add 方法传书籍对象</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    author<span class="token punctuation">.</span>book_set<span class="token punctuation">.</span>add<span class="token punctuation">(</span>book1<span class="token punctuation">,</span> book2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment"># author.book_set.add (book1.pk)  # 方法二</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>author<span class="token punctuation">)</span></pre></td></tr></table></figure><p>其他用法：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>book_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>author_list <span class="token operator">=</span> models<span class="token punctuation">.</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>id__gt<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>book_obj<span class="token punctuation">.</span>authors<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token operator">*</span>author_list<span class="token punctuation">)</span>  <span class="token comment"># 将 id 大于 2 的作者对象添加到这本书的作者集合中</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 方式二：传对象 id</span></pre></td></tr><tr><td data-num="5"></td><td><pre>book_obj<span class="token punctuation">.</span>authors<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 将 id=1 和 id=3 的作者对象添加到这本书的作者集合中</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>pub <span class="token operator">=</span> models<span class="token punctuation">.</span>Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"商务印书馆"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>wo <span class="token operator">=</span> models<span class="token punctuation">.</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"申忠信"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>book <span class="token operator">=</span> wo<span class="token punctuation">.</span>book_set<span class="token punctuation">.</span>create<span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"诗韵词韵速查手册"</span><span class="token punctuation">,</span> price<span class="token operator">=</span><span class="token number">38.00</span><span class="token punctuation">,</span> pub_date<span class="token operator">=</span><span class="token string">"2014-07-01"</span><span class="token punctuation">,</span> publish<span class="token operator">=</span>pub<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>author_obj <span class="token operator">=</span>models<span class="token punctuation">.</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>book_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">11</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>author_obj<span class="token punctuation">.</span>book_set<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>book_obj<span class="token punctuation">)</span>  <span class="token comment"># 移除指定关联</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>book <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"菜鸟教程"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>book<span class="token punctuation">.</span>authors<span class="token punctuation">.</span>clear<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 移除所有关联</span></pre></td></tr></table></figure></li><li><p>查询数据</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询某书籍出版社位置</span></pre></td></tr><tr><td data-num="2"></td><td><pre>book <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>pk<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>res <span class="token operator">=</span> book<span class="token punctuation">.</span>publish<span class="token punctuation">.</span>city</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 查询某出版社的出版记录</span></pre></td></tr><tr><td data-num="7"></td><td><pre>pub <span class="token operator">=</span> models<span class="token punctuation">.</span>Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"人民文学出版社"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>res <span class="token operator">=</span> pub<span class="token punctuation">.</span>book_set<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> res<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>title<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># 查询某作者联系方式</span></pre></td></tr><tr><td data-num="13"></td><td><pre>author <span class="token operator">=</span> models<span class="token punctuation">.</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"贾平凹"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>res <span class="token operator">=</span> author<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>phone</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token comment"># 查询成都作者</span></pre></td></tr><tr><td data-num="18"></td><td><pre>addr <span class="token operator">=</span> models<span class="token punctuation">.</span>AuthorDetail<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>addr<span class="token operator">=</span><span class="token string">"成都"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>res <span class="token operator">=</span> addr<span class="token punctuation">.</span>author<span class="token punctuation">.</span>name</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment"># 查询某书籍的联名作者</span></pre></td></tr><tr><td data-num="23"></td><td><pre>book <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>title<span class="token operator">=</span><span class="token string">"脂砚斋重评石头记"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>res <span class="token operator">=</span> book<span class="token punctuation">.</span>authors<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> res<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>name<span class="token punctuation">,</span> i<span class="token punctuation">.</span>au_detail<span class="token punctuation">.</span>phone<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment"># 查询某作者的所有书籍</span></pre></td></tr><tr><td data-num="29"></td><td><pre>author <span class="token operator">=</span> models<span class="token punctuation">.</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"威廉·萨默塞特·毛姆"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>res <span class="token operator">=</span> author<span class="token punctuation">.</span>book_set<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> res<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>title<span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>双下划线跨表查询</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询某出版社书籍及价格</span></pre></td></tr><tr><td data-num="2"></td><td><pre>res <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>publish__name<span class="token operator">=</span><span class="token string">"凤凰文艺出版社"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values_list<span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> <span class="token string">"price"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>res <span class="token operator">=</span> models<span class="token punctuation">.</span>Publish<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"凤凰文艺出版社"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values_list<span class="token punctuation">(</span><span class="token string">"book__title"</span><span class="token punctuation">,</span><span class="token string">"book__price"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 查询某作者所有书籍名称</span></pre></td></tr><tr><td data-num="6"></td><td><pre>res <span class="token operator">=</span> models<span class="token punctuation">.</span>Book<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>authors__name<span class="token operator">=</span><span class="token string">"张爱玲"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values_list<span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>res <span class="token operator">=</span> models<span class="token punctuation">.</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"张爱玲"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values_list<span class="token punctuation">(</span><span class="token string">"book__title"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 查询某作者联系方式</span></pre></td></tr><tr><td data-num="10"></td><td><pre>res <span class="token operator">=</span> models<span class="token punctuation">.</span>Author<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"汪曾祺"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values_list<span class="token punctuation">(</span><span class="token string">"au_detail__phone"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>res <span class="token operator">=</span> models<span class="token punctuation">.</span>AuthorDetail<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>author__name<span class="token operator">=</span><span class="token string">"汪曾祺"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values_list<span class="token punctuation">(</span><span class="token string">"phone"</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li></ol><blockquote><p>Django ORM 主要思想在于通过操作对象来实现对数据库关联表的增删改查，其实这种通过对象实体之间的关系来操作数据库关联表的技术（或框架）并不鲜见，例如 Java 中的 Spring Data JPA，理解了对象操作的本质，自然一通百通，而不需要强行记忆。</p></blockquote><h3 id="django-form-组件"><a class="anchor" href="#django-form-组件">#</a> Django Form 组件</h3><p>Django Form 组件用于对页面进行初始化，生成 HTML 标签，此外还可以对用户提交对数据进行校验（显示错误信息）。</p><h4 id="使用方式"><a class="anchor" href="#使用方式">#</a> 使用方式</h4><ol><li><p>创建 Form 组件文件。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/My_forms.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django <span class="token keyword">import</span> forms</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> ValidationError</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> app <span class="token keyword">import</span> models</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">EmpForm</span><span class="token punctuation">(</span>forms<span class="token punctuation">.</span>Form<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    name <span class="token operator">=</span> forms<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>min_length<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"姓名"</span><span class="token punctuation">,</span> error_messages<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"min_length"</span><span class="token punctuation">:</span> <span class="token string">"至少需要4个字符"</span><span class="token punctuation">,</span> <span class="token string">"required"</span><span class="token punctuation">:</span> <span class="token string">"该字段不能为空!"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    age <span class="token operator">=</span> forms<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"年龄"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    salary <span class="token operator">=</span> forms<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"工资"</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>视图处理逻辑</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/views.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>http <span class="token keyword">import</span> HttpResponse</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> redirect</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">from</span> app <span class="token keyword">import</span> models</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> app<span class="token punctuation">.</span>My_forms <span class="token keyword">import</span> EmpForm</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">def</span> <span class="token function">add_emp</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        form <span class="token operator">=</span> EmpForm<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"add_emp.html"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"form"</span><span class="token punctuation">:</span> form<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        form <span class="token operator">=</span> EmpForm<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">if</span> form<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 进行数据校验</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token comment"># 校验成功</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            data <span class="token operator">=</span> form<span class="token punctuation">.</span>cleaned_data  <span class="token comment"># 校验成功的值，会放在 cleaned_data 里。</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'r_salary'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>            models<span class="token punctuation">.</span>Emp<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token comment"># return render(request, "add_emp.html", &#123;"form": form&#125;)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>form<span class="token punctuation">.</span>errors<span class="token punctuation">)</span>    <span class="token comment"># 打印错误信息</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            clean_errors <span class="token operator">=</span> form<span class="token punctuation">.</span>errors</pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"add_emp.html"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"form"</span><span class="token punctuation">:</span> form<span class="token punctuation">,</span> <span class="token string">"clean_errors"</span><span class="token punctuation">:</span> clean_errors<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>配置路由：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>path<span class="token punctuation">(</span><span class="token string">'add_emp/'</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>add_emp<span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>新建模板文件</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> mydjango<span class="token operator">/</span>templates<span class="token operator">/</span>add_emp<span class="token punctuation">.</span>html<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>!DOCTYPE html<span class="token operator">></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">&lt;</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token operator">&lt;</span>title<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">&lt;</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token operator">&lt;</span>h3<span class="token operator">></span>添加员工<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">></span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">1</span>、自己手动写HTML页面<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">""</span> method<span class="token operator">=</span><span class="token string">"post"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token operator">&lt;</span>p<span class="token operator">></span>姓名：<span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"name"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token operator">&lt;</span>p<span class="token operator">></span>年龄：<span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"age"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token operator">&lt;</span>p<span class="token operator">></span>工资：<span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"text"</span> name<span class="token operator">=</span><span class="token string">"salary"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">></span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token operator">%</span> csrf_token <span class="token operator">%</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> clean_errors <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">2</span>、通过form对象的as_p方法实现<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">""</span> method<span class="token operator">=</span><span class="token string">"post"</span> novalidate<span class="token operator">></span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token operator">%</span> csrf_token <span class="token operator">%</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> form<span class="token punctuation">.</span>as_p <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">3</span>、手动获取form对象的字段<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">""</span> method<span class="token operator">=</span><span class="token string">"post"</span> novalidate<span class="token operator">></span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token operator">%</span> csrf_token <span class="token operator">%</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token operator">&lt;</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"id_&#123;.&#123; form.name.name &#125;&#125;"</span><span class="token operator">></span>姓名<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> form<span class="token punctuation">.</span>name <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> form<span class="token punctuation">.</span>name<span class="token punctuation">.</span>errors<span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token operator">&lt;</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"id_&#123;.&#123; form.age.name &#125;&#125;"</span><span class="token operator">></span>年龄<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> form<span class="token punctuation">.</span>age <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> form<span class="token punctuation">.</span>age<span class="token punctuation">.</span>errors<span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token operator">&lt;</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"id_salary"</span><span class="token operator">></span>工资<span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> form<span class="token punctuation">.</span>salary <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> form<span class="token punctuation">.</span>salary<span class="token punctuation">.</span>errors<span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre><span class="token operator">&lt;</span>!<span class="token operator">-</span><span class="token operator">-</span> <span class="token number">4</span>、用<span class="token keyword">for</span>循环展示所有字段 <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">></span></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">""</span> method<span class="token operator">=</span><span class="token string">"post"</span> novalidate<span class="token operator">></span></pre></td></tr><tr><td data-num="50"></td><td><pre>    <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token operator">%</span> csrf_token <span class="token operator">%</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token operator">%</span> <span class="token keyword">for</span> field <span class="token keyword">in</span> form <span class="token operator">%</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token operator">&lt;</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="53"></td><td><pre>            <span class="token operator">&lt;</span>label <span class="token keyword">for</span><span class="token operator">=</span><span class="token string">"id_&#123;.&#123; field.name &#125;&#125;"</span><span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> field<span class="token punctuation">.</span>label <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">></span></pre></td></tr><tr><td data-num="54"></td><td><pre>            <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> field <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span> <span class="token operator">&lt;</span>span<span class="token operator">></span><span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token punctuation">&#123;</span> field<span class="token punctuation">.</span>errors<span class="token punctuation">.</span><span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">></span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span></pre></td></tr><tr><td data-num="56"></td><td><pre>    <span class="token punctuation">&#123;</span><span class="token punctuation">.</span><span class="token operator">%</span> endfor <span class="token operator">%</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token operator">&lt;</span><span class="token builtin">input</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">></span></pre></td></tr><tr><td data-num="58"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">></span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>body<span class="token operator">></span></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token operator">&lt;</span><span class="token operator">/</span>html<span class="token operator">></span></pre></td></tr></table></figure></li></ol><h4 id="局部钩子和全局钩子"><a class="anchor" href="#局部钩子和全局钩子">#</a> 局部钩子和全局钩子</h4><p>表单组件：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/My_forms.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django <span class="token keyword">import</span> forms</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>core<span class="token punctuation">.</span>exceptions <span class="token keyword">import</span> ValidationError</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> app <span class="token keyword">import</span> models</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">EmpForm</span><span class="token punctuation">(</span>forms<span class="token punctuation">.</span>Form<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    name <span class="token operator">=</span> forms<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>min_length<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"姓名"</span><span class="token punctuation">,</span> error_messages<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"required"</span><span class="token punctuation">:</span> <span class="token string">"该字段不能为空!"</span><span class="token punctuation">,</span> <span class="token string">"min_length"</span><span class="token punctuation">:</span> <span class="token string">"用户名太短。"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    age <span class="token operator">=</span> forms<span class="token punctuation">.</span>IntegerField<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">"年龄"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    salary <span class="token operator">=</span> forms<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"工资"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    r_salary <span class="token operator">=</span> forms<span class="token punctuation">.</span>DecimalField<span class="token punctuation">(</span>max_digits<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> decimal_places<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">"请再输入工资"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">clean_name</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 局部钩子</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        val <span class="token operator">=</span> self<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">if</span> val<span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token keyword">raise</span> ValidationError<span class="token punctuation">(</span><span class="token string">"用户名不能是纯数字"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">elif</span> models<span class="token punctuation">.</span>Emp<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>name<span class="token operator">=</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token keyword">raise</span> ValidationError<span class="token punctuation">(</span><span class="token string">"用户名已存在！"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">return</span> val</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">clean</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 全局钩子 确认两次输入的工资是否一致。</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        val <span class="token operator">=</span> self<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"salary"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        r_val <span class="token operator">=</span> self<span class="token punctuation">.</span>cleaned_data<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"r_salary"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">if</span> val <span class="token operator">==</span> r_val<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token keyword">return</span> self<span class="token punctuation">.</span>cleaned_data</pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token keyword">raise</span> ValidationError<span class="token punctuation">(</span><span class="token string">"请确认工资是否一致。"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>视图处理：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">add_emp</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        form <span class="token operator">=</span> EmpForm<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 初始化 form 对象</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"add_emp.html"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"form"</span><span class="token punctuation">:</span>form<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        form <span class="token operator">=</span> EmpForm<span class="token punctuation">(</span>request<span class="token punctuation">.</span>POST<span class="token punctuation">)</span>  <span class="token comment"># 将数据传给 form 对象</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token keyword">if</span> form<span class="token punctuation">.</span>is_valid<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 进行校验</span></pre></td></tr><tr><td data-num="8"></td><td><pre>            data <span class="token operator">=</span> form<span class="token punctuation">.</span>cleaned_data</pre></td></tr><tr><td data-num="9"></td><td><pre>            data<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">"r_salary"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>            models<span class="token punctuation">.</span>Emp<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span><span class="token operator">**</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/index/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment"># 校验失败</span></pre></td></tr><tr><td data-num="13"></td><td><pre>            clear_errors <span class="token operator">=</span> form<span class="token punctuation">.</span>errors<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"__all__"</span><span class="token punctuation">)</span>  <span class="token comment"># 获取全局钩子错误信息</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"add_emp.html"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span><span class="token string">"form"</span><span class="token punctuation">:</span> form<span class="token punctuation">,</span> <span class="token string">"clear_errors"</span><span class="token punctuation">:</span> clear_errors<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>模板：</p><figure class="highlight html"><figcaption data-lang="HTML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">novalidate</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    &#123;.% csrf_token %&#125;</pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id_&#123;.&#123; form.name.name &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>姓名<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>        &#123;.&#123; form.name &#125;&#125; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;.&#123; form.name.errors.0 &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id_&#123;.&#123; form.age.name &#125;&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>年龄<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>        &#123;.&#123; form.age &#125;&#125; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;.&#123; form.age.errors.0 &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id_salary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>工资<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>        &#123;.&#123; form.salary &#125;&#125; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;.&#123; form.salary.errors.0 &#125;&#125;&#123;.&#123; clear_errors.0 &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id_r_salary<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>请再输入工资<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        &#123;.&#123; form.r_salary &#125;&#125; <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">></span></span>&#123;.&#123; form.r_salary.errors.0 &#125;&#125;&#123;.&#123; clear_errors.0 &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><blockquote><p>注：这一部分的代码示例基本是从<span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9kamFuZ28vZGphbmdvLWZvcm0tY29tcG9uZW50Lmh0bWw="> Django Form 组件 | 菜鸟教程</span>直接拷贝过来的。（目前的 WEB 应用基本都是前后端分离的，就实际而言，这一小节内容的价值并不大，因此，对于这一部分的代码也未做实际的操作验证）</p></blockquote><h3 id="django-auth"><a class="anchor" href="#django-auth">#</a> Django Auth</h3><p>Django 用户认证组件需要导入 auth 模块：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 认证模块</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> auth</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 对应数据库</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>models <span class="token keyword">import</span> User</pre></td></tr></table></figure><h4 id="用户级别"><a class="anchor" href="#用户级别">#</a> 用户级别</h4><p>可以通过如下方法创建用户对象：</p><ol><li><p><code>create()</code> 创建一个普通用户，密码是明文的。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create<span class="token punctuation">(</span>username<span class="token operator">=</span><span class="token string">'test'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'123456'</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p><code>create_user()</code> 创建一个普通用户，密码是密文的。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_user<span class="token punctuation">(</span>username<span class="token operator">=</span><span class="token string">'zhangsan'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'123456'</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p><code>create_superuser</code> 创建一个超级用户，密码是密文的，要多传一个邮箱 email 参数。</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>create_superuser<span class="token punctuation">(</span>username<span class="token operator">=</span><span class="token string">'chinmoku'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'123456'</span><span class="token punctuation">,</span> email<span class="token operator">=</span><span class="token string">'chinmoku@xxx.com'</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li></ol><h4 id="用户验证"><a class="anchor" href="#用户验证">#</a> 用户验证</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> auth</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"login.html"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    valid_num <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"valid_num"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    keep_str <span class="token operator">=</span> request<span class="token punctuation">.</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"keep_str"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">if</span> keep_str<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> valid_num<span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        user_obj <span class="token operator">=</span> auth<span class="token punctuation">.</span>authenticate<span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span>user_obj<span class="token punctuation">.</span>username<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">if</span> <span class="token keyword">not</span> user_obj<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/login/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>            auth<span class="token punctuation">.</span>login<span class="token punctuation">(</span>request<span class="token punctuation">,</span> user_obj<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            path <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"next"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">"/index/"</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>path<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/login/"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>如果用户账号密码验证通过，则返回该用户对象，否则，返回 None。</p><h4 id="用户注销"><a class="anchor" href="#用户注销">#</a> 用户注销</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib <span class="token keyword">import</span> auth</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">def</span> <span class="token function">logout</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    _out <span class="token operator">=</span> auth<span class="token punctuation">.</span>logout<span class="token punctuation">(</span>request<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>_out<span class="token punctuation">)</span> <span class="token comment"># None</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/login/"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="登录重定向"><a class="anchor" href="#登录重定向">#</a> 登录重定向</h4><p>可以通过装饰器，指定某页面需要登录才能访问：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>contrib<span class="token punctuation">.</span>auth<span class="token punctuation">.</span>decorators <span class="token keyword">import</span> login_required</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token decorator annotation punctuation">@login_required</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">'index.html'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span></pre></td></tr></table></figure><p>此时访问 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTo4MDAwL2luZGV4Lw==">http://127.0.0.1:8000/index/</span> ，如果用户未登录，则会被重定向到 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTo4MDAwL2xvZ2luLz9uZXh0PS9pbmRleC8=">http://127.0.0.1:8000/login/?next=/index/</span> 页面。</p><p>当用户登录时，可以通过如下方式进行处理，使其登录成功后重定向到 <span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMTo4MDAwL2luZGV4Lw==">http://127.0.0.1:8000/index/</span> 页面：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>path <span class="token operator">=</span> request<span class="token punctuation">.</span>GET<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"next"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token string">"/index/"</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">return</span> redirect<span class="token punctuation">(</span>path<span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="cookies-session"><a class="anchor" href="#cookies-session">#</a> Cookies &amp; Session</h3><h4 id="django-cookies-操作"><a class="anchor" href="#django-cookies-操作">#</a> Django Cookies 操作</h4><p>Cookies 在 Django 中的简单应用如下：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"login.html"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>user_obj<span class="token punctuation">.</span>username<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">if</span> <span class="token keyword">not</span> user_obj<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/login/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        rep <span class="token operator">=</span> redirect<span class="token punctuation">(</span><span class="token string">"/index/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        rep<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">"is_login"</span><span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>  <span class="token comment"># 设置 Cookies</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">return</span> rep</pre></td></tr><tr><td data-num="16"></td><td><pre>       </pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>COOKIES<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'is_login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    status <span class="token operator">=</span> request<span class="token punctuation">.</span>COOKIES<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'is_login'</span><span class="token punctuation">)</span>  <span class="token comment"># 获取 Cookies</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">if</span> <span class="token keyword">not</span> status<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/login/'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"index.html"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token keyword">def</span> <span class="token function">logout</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    rep <span class="token operator">=</span> redirect<span class="token punctuation">(</span><span class="token string">'/login/'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    rep<span class="token punctuation">.</span>delete_cookie<span class="token punctuation">(</span><span class="token string">"is_login"</span><span class="token punctuation">)</span>  <span class="token comment"># 删除 Cookies</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">return</span> rep</pre></td></tr><tr><td data-num="28"></td><td><pre>   </pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token keyword">def</span> <span class="token function">order</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>COOKIES<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'is_login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    status <span class="token operator">=</span> request<span class="token punctuation">.</span>COOKIES<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'is_login'</span><span class="token punctuation">)</span>  <span class="token comment"># 获取 Cookies</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token keyword">if</span> <span class="token keyword">not</span> status<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/login/'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"order.html"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="django-session-操作"><a class="anchor" href="#django-session-操作">#</a> Django Session 操作</h4><p>Session 在 Django 中的简单应用如下：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">"GET"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"login.html"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    username <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"username"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    password <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    user_obj <span class="token operator">=</span> models<span class="token punctuation">.</span>UserInfo<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">filter</span><span class="token punctuation">(</span>username<span class="token operator">=</span>username<span class="token punctuation">,</span> password<span class="token operator">=</span>password<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>user_obj<span class="token punctuation">.</span>username<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">if</span> <span class="token keyword">not</span> user_obj<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/session_login/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'is_login'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">True</span>  <span class="token comment"># 设置 session</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        request<span class="token punctuation">.</span>session<span class="token punctuation">[</span><span class="token string">'user1'</span><span class="token punctuation">]</span> <span class="token operator">=</span> username</pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">"/s_index/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">s_index</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    status <span class="token operator">=</span> request<span class="token punctuation">.</span>session<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'is_login'</span><span class="token punctuation">)</span>  <span class="token comment"># 获取 session</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span> <span class="token keyword">not</span> status<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/session_login/'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">"s_index.html"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">def</span> <span class="token function">s_logout</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token comment"># del request.session ["is_login"] # 删除 session_data 里的一组键值对</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    request<span class="token punctuation">.</span>session<span class="token punctuation">.</span>flush<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 删除一条记录包括 (session_key session_data expire_date) 三个字段</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span><span class="token string">'/session_login/'</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h3 id="django-中间件"><a class="anchor" href="#django-中间件">#</a> Django 中间件</h3><p>Django 中间件是修改 Django request 或者 response 对象的钩子，它可以在用户请求之后、服务响应之前做出一些特定的处理。</p><blockquote><p>每个中间件都需要在 <span class="exturl" data-url="aHR0cDovL3NldHRpbmdzLnB5">settings.py</span> 中的 <code>MIDDLEWARE</code> 下进行配置。</p></blockquote><h4 id="自定义中间件"><a class="anchor" href="#自定义中间件">#</a> 自定义中间件</h4><p>创建中间件文件：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/middlewares.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>deprecation <span class="token keyword">import</span> MiddlewareMixin</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MD1</span><span class="token punctuation">(</span>MiddlewareMixin<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token comment"># 中间件需要继承 MiddlewareMixin</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">pass</span></pre></td></tr></table></figure><p>在 <span class="exturl" data-url="aHR0cDovL3NldHRpbmdzLnB5">settings.py</span> 中进行注册：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/mydjango/settings.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre>MIDDLEWARE <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token string">'django.middleware.security.SecurityMiddleware'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token string">'django.contrib.sessions.middleware.SessionMiddleware'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token string">'django.middleware.common.CommonMiddleware'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token string">'django.middleware.csrf.CsrfViewMiddleware'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token string">'django.contrib.auth.middleware.AuthenticationMiddleware'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token string">'django.contrib.messages.middleware.MessageMiddleware'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token string">'django.middleware.clickjacking.XFrameOptionsMiddleware'</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token string">'app.middlewares.MD1'</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure><h4 id="中间件方法"><a class="anchor" href="#中间件方法">#</a> 中间件方法</h4><p>中间件类中可以定义如下方法：</p><ol><li>process_request</li><li>process_view</li><li>process_exception</li><li>process_response</li></ol><p>方法定义实例：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># mydjango/app/middlewares.py</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>deprecation <span class="token keyword">import</span> MiddlewareMixin</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span> HttpResponse</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">MD1</span><span class="token punctuation">(</span>MiddlewareMixin<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">process_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"md1  process_request 方法。"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 在视图之前执行</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">process_response</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 基于请求响应</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"md1  process_response 方法！"</span><span class="token punctuation">,</span> <span class="token builtin">id</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 在视图之后</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token keyword">return</span> response</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">process_view</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> view_func<span class="token punctuation">,</span> view_args<span class="token punctuation">,</span> view_kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"md1  process_view 方法！"</span><span class="token punctuation">)</span>  <span class="token comment"># 在视图之前执行 顺序执行</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token keyword">return</span> view_func<span class="token punctuation">(</span>request<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">process_exception</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 引发错误 才会触发这个方法</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"md1  process_exception 方法！"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>exception<span class="token punctuation">)</span>  <span class="token comment"># 返回错误信息</span></pre></td></tr></table></figure><blockquote><p>注：个人（基于 JAVA）理解，这里的【中间件】概念，其实相当于 Spring 的切面，或者拦截器等，能够在一个请求的整个生命周期中进行监控处理。</p></blockquote><h3 id="fbv-cbv"><a class="anchor" href="#fbv-cbv">#</a> FBV &amp; CBV</h3><ol><li><p>FBV</p><p>FBV（function base views）基于函数的视图，就是在视图里使用函数处理请求。</p><p>其实就是上文中频繁使用的请求处理方式。</p></li><li><p>CBV</p><p>CBV（class base views）基于类的视图，就是在视图里使用类处理请求。</p><p>CBV 主要通过 View 提供的静态方法 <code>as_view()</code> 来实现，as_view 方法是基于类的外部接口，他返回一个视图函数，调用后请求会传递给 dispatch 方法，dispatch 方法再根据不同请求来处理不同的方法。</p><p>示例：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render<span class="token punctuation">,</span>HttpResponse</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> django<span class="token punctuation">.</span>views <span class="token keyword">import</span> View</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Login</span><span class="token punctuation">(</span>View<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># CBV 类需要继承 View</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">get</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"GET 方法"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">post</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        user <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        pwd <span class="token operator">=</span> request<span class="token punctuation">.</span>POST<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"pwd"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token keyword">if</span> user <span class="token operator">==</span> <span class="token string">"runoob"</span> <span class="token keyword">and</span> pwd <span class="token operator">==</span> <span class="token string">"123456"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"POST 方法"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span><span class="token string">"POST 方法 1"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>路由：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>urlpatterns <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    path<span class="token punctuation">(</span><span class="token string">"login/"</span><span class="token punctuation">,</span> views<span class="token punctuation">.</span>Login<span class="token punctuation">.</span>as_view<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">]</span></pre></td></tr></table></figure></li></ol><h3 id="django-部署"><a class="anchor" href="#django-部署">#</a> Django 部署</h3><h4 id="nginx-uwsgi"><a class="anchor" href="#nginx-uwsgi">#</a> Nginx + uwsgi</h4><p><span class="label danger">❗️TODO</span> 待完善</p><h3 id="文末总结"><a class="anchor" href="#文末总结">#</a> 文末总结</h3><div class="note info"><p>写这一篇博客时，先是跟着 B 站视频学了一段，后面觉得讲得一般，就放弃了，转而跟着菜鸟教程编写笔记，断断续续，差不多用了两周多的时间。中途也在看 Django 开发的开源项目，感觉挺有趣的，这里强烈推荐一下：<span class="exturl" data-url="aHR0cHM6Ly9kamFuZ28tdnVlLWFkbWluLmNvbS8=">Django-Vue-Admin</span>，也可能是因为我对若依 Java 那一套很熟悉，所以这个开源项目对我来说，要看懂也不太难。</p></div><h3 id="参考"><a class="anchor" href="#参考">#</a> 参考</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMWkzNDExaTdhTA==">https://www.bilibili.com/video/BV1i3411i7aL</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9kamFuZ28vZGphbmdvLXR1dG9yaWFsLmh0bWw=">https://www.runoob.com/django/django-tutorial.html</span></li></ul><div class="tags"><a href="/tags/python/" rel="tag"><i class="ic i-tag"></i> python</a></div></div><footer><div class="meta"><span id="computer-science/python/django-tutorial/" class="item leancloud_visitors" data-flag-title="Django 网站全栈开发教程" title="閲覧数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">閲覧数</span> <span class="leancloud-visitors-count"></span> <span class="text">回</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 寄付</button><p>*~(￣▽￣)~[お茶]を一杯ください</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="チンモク WeChat 支払う"><p>WeChat 支払う</p></div><div><img data-src="/images/alipay.png" alt="チンモク Alipay"><p>Alipay</p></div><div><img data-src="/images/paypal.png" alt="チンモク PayPal"><p>PayPal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>著者： </strong>チンモク <i class="ic i-at"><em>@</em></i>チンモクのブログ</li><li class="link"><strong>記事へのリンク：</strong> <a href="https://www.chinmoku.cc/computer-science/python/django-tutorial/" title="Django 网站全栈开发教程">https://www.chinmoku.cc/computer-science/python/django-tutorial/</a></li><li class="license"><strong>著作権表示： </strong>このブログ内のすべての記事は、特別な記載がない限り <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> の下のライセンスで保護されています。</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/computer-science/java-learning-path/3-advanced/zookeeper-tutorial/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;reference-1301046789.cos.ap-nanjing.myqcloud.com&#x2F;blog-img&#x2F;301218b88ea34e14bef91ef980cbbd05.jpg" title="Zookeeper 基础教程"><span class="type">前の記事</span> <span class="category"><i class="ic i-flag"></i> 高级篇</span><h3>Zookeeper 基础教程</h3></a></div><div class="item right"><a href="/computer-science/java-learning-path/3-advanced/mongodb-tutorial/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;reference-1301046789.cos.ap-nanjing.myqcloud.com&#x2F;blog-img&#x2F;cac58136ac7e4a4c8b1890f1d9d6030c.jpg" title="MongoDB 基础教程"><span class="type">次の記事</span> <span class="category"><i class="ic i-flag"></i> 高级篇</span><h3>MongoDB 基础教程</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="見出し"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%A6%E4%B9%A0%E5%89%8D%E6%8F%90"><span class="toc-number">1.</span> <span class="toc-text">学习前提</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E5%82%A8%E5%A4%87%E8%A6%81%E6%B1%82"><span class="toc-number">1.1.</span> <span class="toc-text">知识储备要求</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E8%AF%B4%E6%98%8E"><span class="toc-number">1.2.</span> <span class="toc-text">环境说明</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E4%B8%8E%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-number">3.</span> <span class="toc-text">安装与初始化</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85"><span class="toc-number">3.1.</span> <span class="toc-text">虚拟环境安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-django"><span class="toc-number">3.2.</span> <span class="toc-text">安装 Django</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#windows-%E4%B8%8B%E5%AE%89%E8%A3%85"><span class="toc-number">3.3.</span> <span class="toc-text">windows 下安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">3.4.</span> <span class="toc-text">项目结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE"><span class="toc-number">3.5.</span> <span class="toc-text">项目配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#django-%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4"><span class="toc-number">3.6.</span> <span class="toc-text">Django 基础命令</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.</span> <span class="toc-text">Django 模板</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">4.1.</span> <span class="toc-text">准备工作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E4%B8%8E%E6%A8%A1%E6%9D%BF"><span class="toc-number">4.2.</span> <span class="toc-text">路由与模板</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%88%97%E8%A1%A8"><span class="toc-number">4.3.</span> <span class="toc-text">模板：列表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E5%AD%97%E5%85%B8"><span class="toc-number">4.4.</span> <span class="toc-text">模板：字典</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-number">4.5.</span> <span class="toc-text">模板：过滤器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="toc-number">4.6.</span> <span class="toc-text">模板：条件判断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BFifequal"><span class="toc-number">4.7.</span> <span class="toc-text">模板：ifequal</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E6%9D%BF%E6%A0%87%E7%AD%BE"><span class="toc-number">4.8.</span> <span class="toc-text">模板：标签</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90"><span class="toc-number">4.9.</span> <span class="toc-text">静态资源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%87%E7%AD%BE"><span class="toc-number">4.10.</span> <span class="toc-text">自定义标签</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E6%A8%A1%E6%9D%BF%E7%9F%A5%E8%AF%86"><span class="toc-number">4.11.</span> <span class="toc-text">其他模板知识</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.</span> <span class="toc-text">Django 模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE"><span class="toc-number">5.1.</span> <span class="toc-text">数据库配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9E%8B"><span class="toc-number">5.2.</span> <span class="toc-text">定义模型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">5.3.</span> <span class="toc-text">数据库操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-%E8%A1%A8%E5%8D%95"><span class="toc-number">6.</span> <span class="toc-text">Django 表单</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#get"><span class="toc-number">6.1.</span> <span class="toc-text">GET</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#post"><span class="toc-number">6.2.</span> <span class="toc-text">Post</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#request-%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.3.</span> <span class="toc-text">Request 对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#querydict-%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.4.</span> <span class="toc-text">QueryDict 对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-%E8%A7%86%E5%9B%BE"><span class="toc-number">7.</span> <span class="toc-text">Django 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#httpresponse"><span class="toc-number">7.1.</span> <span class="toc-text">HttpResponse</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#render"><span class="toc-number">7.2.</span> <span class="toc-text">render</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#redirect"><span class="toc-number">7.3.</span> <span class="toc-text">redirect</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jsonresponse"><span class="toc-number">7.4.</span> <span class="toc-text">JsonResponse</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-%E8%B7%AF%E7%94%B1"><span class="toc-number">8.</span> <span class="toc-text">Django 路由</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F"><span class="toc-number">8.1.</span> <span class="toc-text">路由配置方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%B7%AF%E7%94%B1"><span class="toc-number">8.2.</span> <span class="toc-text">正则路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%8D%E5%90%91%E8%A7%A3%E6%9E%90"><span class="toc-number">8.3.</span> <span class="toc-text">反向解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="toc-number">8.4.</span> <span class="toc-text">命名空间</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-admin"><span class="toc-number">9.</span> <span class="toc-text">Django Admin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">9.1.</span> <span class="toc-text">配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E4%B8%8E%E4%BD%BF%E7%94%A8"><span class="toc-number">9.2.</span> <span class="toc-text">登录与使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%A1%A8%E5%8D%95"><span class="toc-number">9.3.</span> <span class="toc-text">自定义表单</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-orm"><span class="toc-number">10.</span> <span class="toc-text">Django ORM</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E5%AE%9E%E4%BE%8B"><span class="toc-number">10.1.</span> <span class="toc-text">单表实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%A8%E5%AE%9E%E4%BE%8B"><span class="toc-number">10.2.</span> <span class="toc-text">多表实例</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-form-%E7%BB%84%E4%BB%B6"><span class="toc-number">11.</span> <span class="toc-text">Django Form 组件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">11.1.</span> <span class="toc-text">使用方式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%80%E9%83%A8%E9%92%A9%E5%AD%90%E5%92%8C%E5%85%A8%E5%B1%80%E9%92%A9%E5%AD%90"><span class="toc-number">11.2.</span> <span class="toc-text">局部钩子和全局钩子</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-auth"><span class="toc-number">12.</span> <span class="toc-text">Django Auth</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E7%BA%A7%E5%88%AB"><span class="toc-number">12.1.</span> <span class="toc-text">用户级别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E9%AA%8C%E8%AF%81"><span class="toc-number">12.2.</span> <span class="toc-text">用户验证</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E6%B3%A8%E9%94%80"><span class="toc-number">12.3.</span> <span class="toc-text">用户注销</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%99%BB%E5%BD%95%E9%87%8D%E5%AE%9A%E5%90%91"><span class="toc-number">12.4.</span> <span class="toc-text">登录重定向</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cookies-session"><span class="toc-number">13.</span> <span class="toc-text">Cookies &amp; Session</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#django-cookies-%E6%93%8D%E4%BD%9C"><span class="toc-number">13.1.</span> <span class="toc-text">Django Cookies 操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#django-session-%E6%93%8D%E4%BD%9C"><span class="toc-number">13.2.</span> <span class="toc-text">Django Session 操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">14.</span> <span class="toc-text">Django 中间件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%AD%E9%97%B4%E4%BB%B6"><span class="toc-number">14.1.</span> <span class="toc-text">自定义中间件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%96%B9%E6%B3%95"><span class="toc-number">14.2.</span> <span class="toc-text">中间件方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fbv-cbv"><span class="toc-number">15.</span> <span class="toc-text">FBV &amp; CBV</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#django-%E9%83%A8%E7%BD%B2"><span class="toc-number">16.</span> <span class="toc-text">Django 部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#nginx-uwsgi"><span class="toc-number">16.1.</span> <span class="toc-text">Nginx + uwsgi</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%9C%AB%E6%80%BB%E7%BB%93"><span class="toc-number">17.</span> <span class="toc-text">文末总结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">18.</span> <span class="toc-text">参考</span></a></li></ol></div><div class="related panel pjax" data-title="関連記事"><ul><li><a href="/computer-science/python/python-all-base/" rel="bookmark" title="Python 基础知识全通关">Python 基础知识全通关</a></li><li class="active"><a href="/computer-science/python/django-tutorial/" rel="bookmark" title="Django 网站全栈开发教程">Django 网站全栈开发教程</a></li></ul></div><div class="overview panel" data-title="概要"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="チンモク" data-src="/images/avatar.jpg"><p class="name" itemprop="name">チンモク</p><div class="description" itemprop="description">本站主要以 Java 开发总结文章为主，也会向技术周边进行适当的扩展。此外，偶尔会更新部分其他学习或感兴趣的内容，如语言学习、文本翻译、文艺创作等。</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">23</span> <span class="name">ポスト</span></a></div><div class="item categories"><a href="/categories/"><span class="count">15</span> <span class="name">カテゴリ</span></a></div><div class="item tags"><a href="/tags/"><span class="count">20</span> <span class="name">タグ</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hmYy1leGNsYXZl" title="https:&#x2F;&#x2F;github.com&#x2F;xfc-exclave"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTExMjg2ODg2Mw==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;112868863"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vYW1laGltZQ==" title="https:&#x2F;&#x2F;weibo.com&#x2F;amehime"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnhmY19leGNsYXZlQDE2My5jb20=" title="mailto:xfc_exclave@163.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>ホーム</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>投稿</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>アーカイブ</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>カテゴリ</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>タグ</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-link-circle"></i>リンク</a><ul class="submenu"><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友人帳</a></li><li class="item"><a href="/websites/" rel="section"><i class="ic i-sun"></i>サイト</a></li></ul></li><li class="item"><a href="/plan/" rel="section"><i class="ic i-stars"></i>学習計画</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/computer-science/java-learning-path/3-advanced/zookeeper-tutorial/" rel="prev" title="前の記事"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/computer-science/java-learning-path/3-advanced/mongodb-tutorial/" rel="next" title="次の記事"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>ランダムな記事</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E6%9E%B6%E6%9E%84%E7%AF%87/" title="カテゴリ 架构篇">架构篇</a></div><span><a href="/computer-science/java-learning-path/5-framework/docker-tutorial/" title="给，你要的 Docker 详细教程">给，你要的 Docker 详细教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E5%9F%BA%E7%A1%80%E7%AF%87/" title="カテゴリ 基础篇">基础篇</a></div><span><a href="/computer-science/java-learning-path/1-basic/01-java-basic/" title="JAVA 基础知识大盘点">JAVA 基础知识大盘点</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/language/" title="カテゴリ 语言学习">语言学习</a> <i class="ic i-angle-right"></i> <a href="/categories/language/japanese/" title="カテゴリ 日语">日语</a> <i class="ic i-angle-right"></i> <a href="/categories/language/japanese/standard-japanese/" title="カテゴリ 標準日本語入門">標準日本語入門</a></div><span><a href="/language/japanese/standard-japanese/standard-japanese-01/" title="標準日本語の入門（一）">標準日本語の入門（一）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/JAVA-%E5%AD%A6%E4%B9%A0%E8%B7%AF%E7%BA%BF/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E6%89%A9%E5%B1%95%E7%AF%87/" title="カテゴリ 扩展篇">扩展篇</a></div><span><a href="/computer-science/java-learning-path/6-extension/quartz-tutorial/" title="Quartz 快速入门及常规使用">Quartz 快速入门及常规使用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E8%BF%9B%E9%98%B6%E7%AF%87/" title="カテゴリ 进阶篇">进阶篇</a></div><span><a href="/computer-science/java-learning-path/3-advanced/redis-tutorial/" title="Redis 如何保证高性能">Redis 如何保证高性能</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E8%BF%9B%E9%98%B6%E7%AF%87/" title="カテゴリ 进阶篇">进阶篇</a></div><span><a href="/computer-science/java-learning-path/2-intermediate/webservice-tutorial/" title="WebService，如此而已">WebService，如此而已</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E8%BF%9B%E9%98%B6%E7%AF%87/" title="カテゴリ 进阶篇">进阶篇</a></div><span><a href="/computer-science/java-learning-path/2-intermediate/springcloud-tutorial/" title="SpringCloud 教程（Finchley.RELEASE）">SpringCloud 教程（Finchley.RELEASE）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E8%BF%9B%E9%98%B6%E7%AF%87/" title="カテゴリ 进阶篇">进阶篇</a></div><span><a href="/computer-science/java-learning-path/2-intermediate/dubbo-tutorial/" title="Dubbo 知识整理">Dubbo 知识整理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E5%9F%BA%E7%A1%80%E7%AF%87/" title="カテゴリ 基础篇">基础篇</a></div><span><a href="/computer-science/java-learning-path/1-basic/02-java-concurrency/" title="Java 并发编程知识整理">Java 并发编程知识整理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E9%AB%98%E7%BA%A7%E7%AF%87/" title="カテゴリ 高级篇">高级篇</a></div><span><a href="/computer-science/java-learning-path/3-advanced/mongodb-tutorial/" title="MongoDB 基础教程">MongoDB 基础教程</a></span></li></ul></div><div><h2>最近のコメント</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">チンモク @ Chinmoku</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="単語の総数">594k 単語</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="読書の合計時間">9:01</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"computer-science/python/django-tutorial/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"検索…",empty:"「 ${query} 」については何も見つかりませんでした",stats:"${time} ms以内に ${hits} 件の結果が見つかりました"},valine:!0,fancybox:!0,copyright:"コピーは成功しました。 <br> 再印刷については、 ％s 契約に従ってください。",ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>