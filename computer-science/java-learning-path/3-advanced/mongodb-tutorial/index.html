<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="チンモクのブログ" href="https://www.chinmoku.cc/rss.xml"><link rel="alternate" type="application/atom+xml" title="チンモクのブログ" href="https://www.chinmoku.cc/atom.xml"><link rel="alternate" type="application/json" title="チンモクのブログ" href="https://www.chinmoku.cc/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="java"><link rel="canonical" href="https://www.chinmoku.cc/computer-science/java-learning-path/3-advanced/mongodb-tutorial/"><title>MongoDB 基础教程 - 高级篇 - JAVA 学习路线 - 计算机科学 | Chinmoku = チンモクのブログ = 露の世は　露の世ながら　さりながら</title><meta name="generator" content="Hexo 5.4.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">MongoDB 基础教程</h1><div class="meta"><span class="item" title="作成日：2021-12-28 22:12:53"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">投稿日</span> <time itemprop="dateCreated datePublished" datetime="2021-12-28T22:12:53+08:00">2021-12-28</time> </span><span class="item" title="単語数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">単語数</span> <span>20k</span> <span class="text">単語</span> </span><span class="item" title="読書の時間"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">読書の時間</span> <span>18 分</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="ナビゲーションバーの切り替え"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Chinmoku</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/7b434bd12ce94b39a8a22dd5d01c4a3f.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/2e0f5228e68f45808fce8c43266bb459.png"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/0a689f61e87d4245b3850e6641565b4b.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/41ce2e4e59784c6386095ecf1e7d7b2f.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/1fd06c0541724af78dc525c547098fab.jpg"></li><li class="item" data-background-image="https://reference-1301046789.cos.ap-nanjing.myqcloud.com/blog-img/35500212880a11ebb6edd017c2d2eca2.png"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">ホーム</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/" itemprop="item" rel="index" title="カテゴリ 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/java-learning-path/" itemprop="item" rel="index" title="カテゴリ JAVA 学习路线"><span itemprop="name">JAVA 学习路线</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/java-learning-path/%E9%AB%98%E7%BA%A7%E7%AF%87/" itemprop="item" rel="index" title="カテゴリ 高级篇"><span itemprop="name">高级篇</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="ja"><link itemprop="mainEntityOfPage" href="https://www.chinmoku.cc/computer-science/java-learning-path/3-advanced/mongodb-tutorial/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="チンモク"><meta itemprop="description" content="露の世は　露の世ながら　さりながら, 本站主要以 Java 开发总结文章为主，也会向技术周边进行适当的扩展。此外，偶尔会更新部分其他学习或感兴趣的内容，如语言学习、文本翻译、文艺创作等。"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="チンモクのブログ"></span><div class="body md" itemprop="articleBody"><p><img data-src="https://img.xfc-exclave.com/2021/12/88c902e77a46c54c6e3bd9eaa6601ab51640271078.png" alt="mongodb-logo"></p><h3 id="nosql-简介"><a class="anchor" href="#nosql-简介">#</a> NoSQL 简介</h3><p>NoSQL，指的是非关系型的数据库。NoSQL 是 Not Only SQL 的缩写，是对不同于传统的关系型数据库的数据库管理系统的统称。NoSQL 通常用于超大规模数据的存储（如谷歌或 Facebook 每天为他们的用户收集万亿比特的数据），这些类型的数据存储不需要固定的模式，无需多余操作就可以横向扩展。</p><h4 id="nosql-优缺点"><a class="anchor" href="#nosql-优缺点">#</a> NoSQL 优缺点</h4><p>优点：</p><ul><li>高可扩展性</li><li>分布式计算</li><li>低成本</li><li>架构的灵活性，半结构化数据</li><li>没有复杂的关系</li></ul><p>缺点：</p><ul><li>没有标准化</li><li>有限的查询功能（到目前为止）</li><li>最终一致是不直观的程序</li></ul><h4 id="rdbms-vs-nosql"><a class="anchor" href="#rdbms-vs-nosql">#</a> RDBMS vs NoSQL</h4><p>关系型数据库（RDBMS）与非关系型数据库（NoSQL）对比：</p><table><thead><tr><th>对比项</th><th>RDBMS</th><th>NoSQL</th></tr></thead><tbody><tr><td>存储格式</td><td>表格式，行和列</td><td>文档、键值对、图结构</td></tr><tr><td>存储规范</td><td>规范性，避免重复</td><td>鼓励冗余</td></tr><tr><td>存储扩展</td><td>纵向扩展 (横向扩展有限)</td><td>横向扩展，分布式</td></tr><tr><td>查询方式</td><td>结构化查询</td><td>非结构化查询语言 SQL</td></tr><tr><td>事务</td><td>支持事务</td><td>不支持事务一致性</td></tr><tr><td>性能</td><td>读写性能差</td><td>读写性能高</td></tr><tr><td>成本</td><td>成本高</td><td>简单易部署，开源，成本低</td></tr><tr><td>存储方式</td><td>数据主要存储在磁盘中</td><td>数据主要存储在内存中（部分可以持久化到磁盘）</td></tr><tr><td>建表原则</td><td>依靠关系模型构建关联</td><td>数据模型比较简单，用 K/V 的形式来存储数据</td></tr></tbody></table><h3 id="mongodb-简介"><a class="anchor" href="#mongodb-简介">#</a> MongoDB 简介</h3><p>MongoDB 是由 <code>C++</code> 语言编写的，是一个基于分布式文件存储的开源非关系型数据库系统。在高负载的情况下，添加更多的节点，可以保证服务器性能。MongoDB 旨在为 WEB 应用提供可扩展的高性能数据存储解决方案。MongoDB 将数据存储为一个文档，数据结构由键值（key=&gt;value）对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</p><p>MongoDB 使用 BSON（Binary JSON）对象来存储，与 JSON 格式的键值对（key/value）类似，字段值可以包含其他文档，数组及文档数组。支持的查询语言非常强大，其语法有点类似于面向对象的查询语言，几乎可以实现类似关系型数据库单表查询的绝大部分功能，而且还支持对数据建立索引。</p><h4 id="mongodb-主要特点"><a class="anchor" href="#mongodb-主要特点">#</a> MongoDB 主要特点</h4><ul><li>MongoDB 是一个面向文档存储的数据库，操作起来比较简单和容易。</li><li>你可以在 MongoDB 记录中设置任何属性的索引 （如：FirstName=&quot;Sameer&quot;,Address=&quot;8 Gandhi Road&quot;）来实现更快的排序。</li><li>你可以通过本地或者网络创建数据镜像，这使得 MongoDB 有更强的扩展性。</li><li>如果负载的增加（需要更多的存储空间和更强的处理能力） ，它可以分布在计算机网络中的其他节点上这就是所谓的分片。</li><li>Mongo 支持丰富的查询表达式。查询指令使用 JSON 形式的标记，可轻易查询文档中内嵌的对象及数组。</li><li>MongoDB 使用 update () 命令可以实现替换完成的文档（数据）或者一些指定的数据字段 。</li><li>MongoDB 中的 Map/reduce 主要是用来对数据进行批量处理和聚合操作。</li><li>Map 和 Reduce。Map 函数调用 emit (key,value) 遍历集合中所有的记录，将 key 与 value 传给 Reduce 函数进行处理。</li><li>Map 函数和 Reduce 函数是使用 Javascript 编写的，并可以通过 db.runCommand 或 mapreduce 命令来执行 MapReduce 操作。</li><li>GridFS 是 MongoDB 中的一个内置功能，可以用于存放大量小文件。</li><li>MongoDB 允许在服务端执行脚本，可以用 Javascript 编写某个函数，直接在服务端执行，也可以把函数的定义存储在服务端，下次直接调用即可。</li><li>MongoDB 支持各种编程语言：RUBY，PYTHON，JAVA，C++，PHP，C# 等多种语言。</li><li>MongoDB 安装简单。</li></ul><h4 id="mongodb-数据类型"><a class="anchor" href="#mongodb-数据类型">#</a> MongoDB 数据类型</h4><table><thead><tr><th>数据类型</th><th>描述</th></tr></thead><tbody><tr><td>String</td><td>字符串。存储数据常用的数据类型。在 MongoDB 中，UTF-8 编码的字符串才是合法的。</td></tr><tr><td>Integer</td><td>整型数值。用于存储数值。根据你所采用的服务器，可分为 32 位或 64 位。</td></tr><tr><td>Boolean</td><td>布尔值。用于存储布尔值（真 / 假）。</td></tr><tr><td>Double</td><td>双精度浮点值。用于存储浮点值。</td></tr><tr><td>Min/Max keys</td><td>将一个值与 BSON（二进制的 JSON）元素的最低值和最高值相对比。</td></tr><tr><td>Arrays</td><td>用于将数组或列表或多个值存储为一个键。</td></tr><tr><td>Timestamp</td><td>时间戳。记录文档修改或添加的具体时间。</td></tr><tr><td>Object</td><td>用于内嵌文档。</td></tr><tr><td>Null</td><td>用于创建空值。</td></tr><tr><td>Symbol</td><td>符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。</td></tr><tr><td>Date</td><td>日期时间。用 UNIX 时间格式来存储当前日期或时间。你可以指定自己的日期时间：创建 Date 对象，传入年月日信息。</td></tr><tr><td>Object ID</td><td>对象 ID。用于创建文档的 ID。</td></tr><tr><td>Binary Data</td><td>二进制数据。用于存储二进制数据。</td></tr><tr><td>Code</td><td>代码类型。用于在文档中存储 JavaScript 代码。</td></tr><tr><td>Regular expression</td><td>正则表达式类型。用于存储正则表达式。</td></tr></tbody></table><h4 id="mongodb-支持语言"><a class="anchor" href="#mongodb-支持语言">#</a> MongoDB 支持语言</h4><p><img data-src="https://img.xfc-exclave.com/2021/12/561f02944ca42fc819c495e03c2b43bc1640271138.png" alt="mongodb_lang"></p><h3 id="下载与安装"><a class="anchor" href="#下载与安装">#</a> 下载与安装</h3><h4 id="windows-环境"><a class="anchor" href="#windows-环境">#</a> Windows 环境</h4><ul><li><p>官网地址：<span class="exturl" data-url="aHR0cHM6Ly93d3cubW9uZ29kYi5jb20=">https://www.mongodb.com</span></p></li><li><p>下载地址：<span class="exturl" data-url="aHR0cHM6Ly93d3cubW9uZ29kYi5jb20vdHJ5L2Rvd25sb2Fk">https://www.mongodb.com/try/download</span></p></li></ul><p><img data-src="https://img.xfc-exclave.com/2021/12/1dc378837afe9e2bbf8e8f1b3d240c171640271166.png" alt="mongo_download"></p><p>双击可执行文件 <code>.msi</code> ，进行安装（基本上下一步即可）。</p><p>推荐选择自定义安装：</p><p><img data-src="https://img.xfc-exclave.com/2021/12/40520416960e56e4da5556ef7a688b271640273049.png" alt="mongo_install"></p><p>推荐取消默认的 <code>Install MongoDB Compass</code> 安装。</p><p>MongoDB 配置：</p><ol><li><p>环境变量</p><p>编辑系统变量 <code>Path</code> 并添加 MongoDB 的 bin 目录位置。例如： <code>A:\MongoDB\Server\5.0\bin</code></p></li><li><p>创建数据库文件的存放位置</p><p>创建文件夹 <code>[MongoDB]\data\db</code> 。</p><blockquote><p>这是因为 MongoDB 服务在启动之前必须创建数据库文件的存放文件夹，否则命令不会自动创建，且服务无法启动成功。</p></blockquote></li><li><p>启动 MongoDB 服务</p><p><code>cmd</code> 命令进入安装目录 <code>[MongoDB]\data\bin</code> 位置，执行如下命令：</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>A:<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">5.0</span><span class="token punctuation">\</span>bin<span class="token operator">></span> mongod --dbpath A:<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">5.0</span><span class="token punctuation">\</span>data<span class="token punctuation">\</span>db</pre></td></tr></table></figure><p>浏览器访问：<span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMToyNzAxNw==">http://127.0.0.1:27017</span>，如果出现如下信息，则表示配置成功且服务已启动：</p><blockquote><p>It looks like you are trying to access MongoDB over HTTP on the native driver port.</p></blockquote></li><li><p>配置本地 MongoDB 服务</p><p>创建文件夹 <code>[MongoDB]\data\log</code> ，用于存放日志文件。</p><p>创建配置文件 <code>[MongoDB]\mongo.config</code> ：</p><figure class="highlight properties"><figcaption data-lang=".properties"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token attr-name">dbpath</span><span class="token punctuation">=</span><span class="token attr-value">A:\MongoDB\Server\5.0\data\db</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token attr-name">logpath</span><span class="token punctuation">=</span><span class="token attr-value">A:\MongoDB\Server\5.0\data\log\mongo.log</span></pre></td></tr></table></figure><p>使用管理员角色执行如下命令：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 停止已启动的 MongoDB 服务</span></pre></td></tr><tr><td data-num="2"></td><td><pre>net stop MongoDB</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 移除 MongoDB 服务</span></pre></td></tr><tr><td data-num="4"></td><td><pre>sc delete MongoDB</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 安装 MongoDB 服务</span></pre></td></tr><tr><td data-num="6"></td><td><pre>mongod -dbpath <span class="token string">"A:\MongoDB\Server<span class="token entity" title="\5">\5</span>.0\data\db"</span> -logpath <span class="token string">"A:\MongoDB\Server<span class="token entity" title="\5">\5</span>.0\data\log\mongo.log"</span> -install -serviceName <span class="token string">"MongoDB"</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 启动 MongoDB 服务</span></pre></td></tr><tr><td data-num="8"></td><td><pre>net start MongoDB</pre></td></tr></table></figure><p>浏览器访问：<span class="exturl" data-url="aHR0cDovLzEyNy4wLjAuMToyNzAxNw==">http://127.0.0.1:27017</span></p><p>客户端连接：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>A:<span class="token punctuation">\</span>MongoDB<span class="token punctuation">\</span>Server<span class="token punctuation">\</span><span class="token number">5.0</span><span class="token punctuation">\</span>bin<span class="token operator">></span> mongo.exe</pre></td></tr></table></figure></li></ol><h4 id="linux-环境"><a class="anchor" href="#linux-环境">#</a> Linux 环境</h4><ol><li><p>卸载删除</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 停止服务</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">ps</span> -ef <span class="token operator">|</span> <span class="token function">grep</span> mongo</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">kill</span> -9 xxx</pre></td></tr><tr><td data-num="4"></td><td><pre>net stop mongodb</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">sudo</span> yum erase <span class="token variable"><span class="token variable">$(</span><span class="token function">rpm</span> -qa <span class="token operator">|</span> <span class="token function">grep</span> mongodb-org<span class="token variable">)</span></span> <span class="token comment">#卸载 MongoDB</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">sudo</span> <span class="token function">rm</span> -r /var/log/mongodb <span class="token comment">#删除日志文件</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">sudo</span> <span class="token function">rm</span> -r /var/lib/mongo  <span class="token comment">#删除数据文件</span></pre></td></tr></table></figure></li><li><p>安装</p><p>配置 yum 源：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token builtin class-name">cd</span> /etc/yum.repos.d</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">vi</span> mongodb-org-5.0.repo</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 版本选择可前往 https://repo.mongodb.org 进行查看。</span></pre></td></tr></table></figure><p>编辑如下内容（版本号视个人需要而定）：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>mongodb-org-5.0<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token assign-left variable">name</span><span class="token operator">=</span>MongoDB Repository</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token assign-left variable">baseurl</span><span class="token operator">=</span>https://repo.mongodb.org/yum/redhat/7Server/mongodb-org/5.0/x86_64/</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token assign-left variable">gpgcheck</span><span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">enabled</span><span class="token operator">=</span><span class="token number">1</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token assign-left variable">gpgkey</span><span class="token operator">=</span>https://www.mongodb.org/static/pgp/server-5.0.asc</pre></td></tr></table></figure><blockquote><p>提示：具体版本，可前往源地址进行查看选择：<span class="exturl" data-url="aHR0cHM6Ly9yZXBvLm1vbmdvZGIub3Jn">https://repo.mongodb.org</span></p></blockquote><p>执行安装：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>yum <span class="token function">install</span> -y mongodb-org</pre></td></tr></table></figure><p>修改配置：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">vim</span> /etc/mongod.conf</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># network interfaces</span></pre></td></tr><tr><td data-num="4"></td><td><pre>net:</pre></td></tr><tr><td data-num="5"></td><td><pre>  port: <span class="token number">27017</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  bindIp: <span class="token number">0.0</span>.0.0  <span class="token comment"># Enter 0.0.0.0,:: to bind to all IPv4 and IPv6 addresses or, alternatively, use the net.bindIpAll setting.</span></pre></td></tr></table></figure><p>基本命令：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>systemctl start mongod.service　　<span class="token comment"># 启动</span></pre></td></tr><tr><td data-num="2"></td><td><pre>systemctl status mongod.service　 <span class="token comment"># 查看状态</span></pre></td></tr><tr><td data-num="3"></td><td><pre>systemctl stop mongod.service 　　<span class="token comment"># 停止</span></pre></td></tr><tr><td data-num="4"></td><td><pre>systemctl <span class="token builtin class-name">enable</span> mongod.service 　<span class="token comment"># 自启</span></pre></td></tr></table></figure><p>测试连接：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>mongo <span class="token number">127.0</span>.0.1:27017 <span class="token comment"># 如果是默认 IP 端口，可以不指定</span></pre></td></tr></table></figure><p>权限控制：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>use admin <span class="token comment"># 其他数据库也类似</span></pre></td></tr><tr><td data-num="2"></td><td><pre>switched to db admin</pre></td></tr><tr><td data-num="3"></td><td><pre>db.createUser<span class="token punctuation">(</span><span class="token punctuation">&#123;</span> user:<span class="token string">"admin"</span>, pwd:<span class="token string">"123456"</span>, roles:<span class="token punctuation">[</span><span class="token string">"root"</span><span class="token punctuation">]</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre>Successfully added user: <span class="token punctuation">&#123;</span> <span class="token string">"user"</span> <span class="token builtin class-name">:</span> <span class="token string">"admin"</span>, <span class="token string">"roles"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">[</span> <span class="token string">"root"</span> <span class="token punctuation">]</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>db.auth<span class="token punctuation">(</span><span class="token string">"admin"</span>, <span class="token string">"123456"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">1</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token builtin class-name">exit</span></pre></td></tr><tr><td data-num="8"></td><td><pre>bye</pre></td></tr><tr><td data-num="9"></td><td><pre>mongo -u root -p <span class="token number">123456</span> <span class="token comment"># 账号登录</span></pre></td></tr></table></figure><p>启用身份验证：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">vi</span> /etc/mongod.conf</pre></td></tr><tr><td data-num="2"></td><td><pre>   </pre></td></tr><tr><td data-num="3"></td><td><pre>security:</pre></td></tr><tr><td data-num="4"></td><td><pre>     authorization: enabled   <span class="token comment"># disable or enabled</span></pre></td></tr></table></figure></li><li><p>问题排查</p><ul><li><p>MongoDB 服务启动失败，可以使用 <code>journalctl -xe</code> 命令跟踪更加详细的信息，通常是由于以下几种原因导致的：</p><ol><li>mongod.conf 配置内容或语法错误。</li><li>日志访问权限不足。</li><li>锁定</li></ol></li><li><p>如果服务器本地可以访问 MongoDB，但远程访问失败，请检查：</p><ol><li>检查配置文件 <code>/etc/mongod.conf</code> IP 是否放开、是否允许远程访问，以及访问账号密钥信息。</li><li>云服务器需注意配置安全组规则。</li><li>如已开启防火墙，需添放开对应端口。</li></ol></li><li><p>命令提示</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查看与修改</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token function">vi</span> /etc/mongod.conf <span class="token comment"># MongoDB 配置文件</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token function">cat</span> /usr/lib/systemd/system/mongod.service <span class="token comment"># MongoDB 服务</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 权限或 mongodb 锁文件</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token function">sudo</span> <span class="token function">chown</span> -Rc mongodb. /var/log/mongodb</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token function">sudo</span> <span class="token function">chown</span> -Rc mongodb. /var/lib/mongo</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token function">rm</span> -rf /var/lib/mongo/mongod.lock</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token function">rm</span> -rf /tmp/mongodb-27017.sock</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 防火墙</span></pre></td></tr><tr><td data-num="10"></td><td><pre>firewall-cmd --state <span class="token comment"># 查看防火墙状态</span></pre></td></tr><tr><td data-num="11"></td><td><pre>systemctl stop firewalld.service <span class="token comment"># 关闭防火墙</span></pre></td></tr><tr><td data-num="12"></td><td><pre>systemctl start firewalld.service <span class="token comment"># 开启防火墙</span></pre></td></tr><tr><td data-num="13"></td><td><pre>firewall-cmd --add-port<span class="token operator">=</span><span class="token number">27017</span>/tcp --permanent <span class="token comment"># 防火墙放开指定端口（永久）</span></pre></td></tr><tr><td data-num="14"></td><td><pre>firewall-cmd --zone<span class="token operator">=</span>public --list-ports <span class="token comment"># 查看防火墙已开放端口</span></pre></td></tr><tr><td data-num="15"></td><td><pre>firewall-cmd --reload <span class="token comment"># 防火墙配置重新载入</span></pre></td></tr></table></figure><blockquote><p>配置参考：<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2UvY29uZmlndXJhdGlvbi1vcHRpb25z">https://docs.mongodb.com/manual/reference/configuration-options</span></p></blockquote></li></ul></li></ol><h4 id="mongodb-gui"><a class="anchor" href="#mongodb-gui">#</a> MongoDB GUI</h4><ul><li><p><span class="exturl" data-url="aHR0cHM6Ly9yb2JvbW9uZ28ub3JnL2Rvd25sb2Fk">Robo 3T / Studio 3T</span></p><p><img data-src="https://img.xfc-exclave.com/2021/12/76413eb9f3f06806e7ebad3a7605d7dc1640331051.png" alt="Robo 3T / Studio 3T"></p></li><li><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubmF2aWNhdC5jb20=">Navicat</span></p><p><img data-src="https://img.xfc-exclave.com/2021/12/67a7e58152813db91e164a9718259ceb1640331382.png" alt="image-20211224153611400"></p></li></ul><h3 id="术语与概念"><a class="anchor" href="#术语与概念">#</a> 术语与概念</h3><p>SQL 数据库与 MongoDB 数据库术语及概念的对比：</p><table><thead><tr><th style="text-align:left">SQL 术语 / 概念</th><th style="text-align:left">MongoDB 术语 / 概念</th><th style="text-align:left">解释 / 说明</th></tr></thead><tbody><tr><td style="text-align:left">database</td><td style="text-align:left">database</td><td style="text-align:left">数据库</td></tr><tr><td style="text-align:left">table</td><td style="text-align:left">collection</td><td style="text-align:left">数据库表 / 集合</td></tr><tr><td style="text-align:left">row</td><td style="text-align:left">document</td><td style="text-align:left">数据记录行 / 文档</td></tr><tr><td style="text-align:left">column</td><td style="text-align:left">field</td><td style="text-align:left">数据字段 / 域</td></tr><tr><td style="text-align:left">index</td><td style="text-align:left">index</td><td style="text-align:left">索引</td></tr><tr><td style="text-align:left">table joins</td><td style="text-align:left"></td><td style="text-align:left">表连接，MongoDB 不支持</td></tr><tr><td style="text-align:left">primary key</td><td style="text-align:left">primary key</td><td style="text-align:left">主键，MongoDB 自动将_id 字段设置为主键</td></tr></tbody></table><h4 id="数据库"><a class="anchor" href="#数据库">#</a> 数据库</h4><p>一个 mongodb 中可以建立多个数据库。MongoDB 的默认数据库为 <code>db</code> ，该数据库存储在 data 目录中，这一点我们在安装配置时已有提及。</p><p>MongoDB 的单个实例可以容纳多个独立的数据库，每一个都有自己的集合和权限，不同的数据库也放置在不同的文件中。</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">></span> show dbs <span class="token comment"># 显示所有数据列表</span></pre></td></tr><tr><td data-num="2"></td><td><pre>admin   <span class="token number">0</span>.000GB</pre></td></tr><tr><td data-num="3"></td><td><pre>config  <span class="token number">0</span>.000GB</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token builtin class-name">local</span>   <span class="token number">0</span>.000GB</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">></span> db <span class="token comment"># 显示当前数据库对象或集合</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token builtin class-name">test</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">></span> use <span class="token builtin class-name">local</span> <span class="token comment"># 切换到指定数据库</span></pre></td></tr><tr><td data-num="8"></td><td><pre>switched to db <span class="token builtin class-name">local</span></pre></td></tr></table></figure><p>MongoDB 默认有三个数据库：</p><ul><li>admin：从权限的角度来看，这是 root 数据库。要是将一个用户添加到这个数据库，这个用户自动继承所有数据库的权限。一些特定的服务器端命令也只能从这个数据库运行，比如列出所有的数据库或者关闭服务器。</li><li>local：这个数据永远不会被复制，可以用来存储限于本地单台服务器的任意集合</li><li>config： 当 Mongo 用于分片设置时，config 数据库在内部使用，用于保存分片的相关信息。</li></ul><h4 id="文档"><a class="anchor" href="#文档">#</a> 文档</h4><p>文档是一组键值对（即 BSON），示例：</p><figure class="highlight json"><figcaption data-lang="JSON"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">&#123;</span><span class="token property">"site"</span><span class="token operator">:</span><span class="token string">"www.chinmoku.cc"</span><span class="token punctuation">,</span> <span class="token property">"author"</span><span class="token operator">:</span><span class="token string">"Chinmoku"</span><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>RDBMS 与 MongoDB 术语对比：</p><table><thead><tr><th style="text-align:left">RDBMS</th><th style="text-align:left">MongoDB</th></tr></thead><tbody><tr><td style="text-align:left">数据库</td><td style="text-align:left">数据库</td></tr><tr><td style="text-align:left">表格</td><td style="text-align:left">集合</td></tr><tr><td style="text-align:left">行</td><td style="text-align:left">文档</td></tr><tr><td style="text-align:left">列</td><td style="text-align:left">字段</td></tr><tr><td style="text-align:left">表联合</td><td style="text-align:left">嵌入文档</td></tr><tr><td style="text-align:left">主键</td><td style="text-align:left">主键（MongoDB 提供了 key 为 _id）</td></tr></tbody></table><p>注意：</p><ol><li>文档中的键值对是有序的。</li><li>文档中的值不仅可以是在双引号里面的字符串，还可以是其他几种数据类型（甚至可以是整个嵌入的文档)。</li><li>MongoDB 区分类型和大小写。</li><li>MongoDB 的文档不能有重复的键。</li><li>文档的键是字符串，除少数例外情况，键可以使用任意 UTF-8 字符。</li></ol><p>文档键命名规范：</p><ul><li>键不能含有空字符。这个字符用来表示键的结尾。</li><li><code>.</code> 和 <code>$</code> 有特别的意义，只有在特定环境下才能使用。</li><li>以下划线开头的键是保留的（不是严格要求的）。</li></ul><h4 id="集合"><a class="anchor" href="#集合">#</a> 集合</h4><p>集合就是 MongoDB 文档组，类似于 RDBMS 中的表。集合存在于数据库中，集合没有固定的结构。</p><p>集合的合法性：</p><ul><li>集合名不能是空字符串。</li><li>集合名不能含有 <code>\0</code> 空字符，这个字符表示集合名的结尾。</li><li>集合名不能以 <code>system.</code> 开头，这是为系统集合保留的前缀。</li><li>用户创建的集合名字不能含有保留字符。有些驱动程序的确支持在集合名里面包含，这是因为某些系统生成的集合中包含该字符。</li></ul><h5 id="capped-collections"><a class="anchor" href="#capped-collections">#</a> Capped Collections</h5><p>Capped collections 就是固定大小的 collection，它是高性能自动的维护对象的插入顺序。它非常适合类似记录日志的功能和标准的 collection 不同，你必须要显式的创建一个 capped collection，指定一个 collection 的大小，单位是字节。collection 的数据存储空间值提前分配的。</p><p>Capped collections 可以按照文档的插入顺序保存到集合中，而且这些文档在磁盘上存放位置也是按照插入顺序来保存的，所以当我们更新 Capped collections 中文档的时候，更新后的文档不可以超过之前文档的大小，这样话就可以确保所有文档在磁盘上的位置一直保持不变。</p><p>由于 Capped collection 是按照文档的插入顺序而不是使用索引确定插入位置，这样的话可以提高增添数据的效率。MongoDB 的操作日志文件 <span class="exturl" data-url="aHR0cDovL29wbG9nLnJz">oplog.rs</span> 就是利用 Capped Collection 来实现的。</p><p>要注意的是指定的存储大小包含了数据库的头信息。</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre>db<span class="token punctuation">.</span><span class="token function">createCollection</span><span class="token punctuation">(</span><span class="token string">"mycoll"</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>capped<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span> size<span class="token operator">:</span><span class="token number">100000</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="元数据"><a class="anchor" href="#元数据">#</a> 元数据</h4><p>在 MongoDB 数据库中命名空间 <code>&lt;dbname&gt;.system.*</code> 是包含多种系统信息的特殊集合（Collection），如下：</p><table><thead><tr><th style="text-align:left">集合命名空间</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">dbname.system.namespaces</td><td style="text-align:left">列出所有名字空间。</td></tr><tr><td style="text-align:left">dbname.system.indexes</td><td style="text-align:left">列出所有索引。</td></tr><tr><td style="text-align:left">dbname.system.profile</td><td style="text-align:left">包含数据库概要（profile）信息。</td></tr><tr><td style="text-align:left">dbname.system.users</td><td style="text-align:left">列出所有可访问数据库的用户。</td></tr><tr><td style="text-align:left">dbname.local.sources</td><td style="text-align:left">包含复制对端（slave）的服务器信息和状态。</td></tr></tbody></table><h4 id="objectid"><a class="anchor" href="#objectid">#</a> ObjectId</h4><p>ObjectId 类似唯一主键，可以很快的去生成和排序，它包含 12 个字节，其含义如下：</p><ul><li>前 4 个字节表示创建 unix 时间戳，格林尼治时间 UTC 时间，比北京时间晚了 8 个小时。</li><li>接下来的 3 个字节是机器标识码。</li><li>紧接的两个字节由进程 id 组成 PID。</li><li>最后三个字节是随机数。</li></ul><p>使用方式：</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> newObject <span class="token operator">=</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre>newObject<span class="token punctuation">.</span><span class="token function">getTimestamp</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>newObject<span class="token punctuation">.</span>str</pre></td></tr></table></figure><h4 id="时间与字符串"><a class="anchor" href="#时间与字符串">#</a> 时间与字符串</h4><ol><li><p>BSON 字符串</p><p>BSON 字符串都是 UTF-8 编码。</p></li><li><p>时间戳</p><p>BSON 有一个特殊的时间戳类型用于 MongoDB 内部使用，与普通的日期类型不相关。</p><p>在单个 mongod 实例中，时间戳值通常是唯一的。</p><p>在复制集中，oplog 有一个 ts 字段。这个字段中的值使用 BSON 时间戳表示了操作时间。</p><blockquote><p>BSON 时间戳类型主要用于 MongoDB 内部使用。</p></blockquote></li><li><p>日期</p><p>表示当前距离 Unix 新纪元（1970 年 1 月 1 日）的毫秒数。日期类型是有符号的，负数表示 1970 年之前的日期，创建及使用方式如下：</p><figure class="highlight js"><figcaption data-lang="JavaScript"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">var</span> mydate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">typeof</span> mydate</pre></td></tr><tr><td data-num="3"></td><td><pre>mydate<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token function">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这样创建的时间是日期类型，可以使用 JS 中的 Date 类型的方法。</p></li></ol><h3 id="基本操作"><a class="anchor" href="#基本操作">#</a> 基本操作</h3><h4 id="数据库操作"><a class="anchor" href="#数据库操作">#</a> 数据库操作</h4><ol><li><p>创建连接</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 连接实例：</span></pre></td></tr><tr><td data-num="2"></td><td><pre>mongodb://root:123456@127.0.0.1/test</pre></td></tr></table></figure><blockquote><p>更多 MongoDB 连接配置，参考：<span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9tb25nb2RiL21vbmdvZGItY29ubmVjdGlvbnMuaHRtbA==">https://www.runoob.com/mongodb/mongodb-connections.html</span></p></blockquote></li><li><p>创建或切换数据库</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 如果不存在，则创建，如果已存在，则切换</span></pre></td></tr><tr><td data-num="2"></td><td><pre>use mytest</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 查看所有数据库（当创建的数据库没有数据时，不会显示）</span></pre></td></tr><tr><td data-num="4"></td><td><pre>show dbs</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 插入一条数据</span></pre></td></tr><tr><td data-num="6"></td><td><pre>db.col1.insert<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token builtin class-name">:</span><span class="token string">"Chinmoku"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 再次查询数据库列表</span></pre></td></tr><tr><td data-num="8"></td><td><pre>show dbs</pre></td></tr></table></figure></li><li><p>删除数据库</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>use mytest</pre></td></tr><tr><td data-num="2"></td><td><pre>db.dropDatabase<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li></ol><h4 id="集合与文档操作"><a class="anchor" href="#集合与文档操作">#</a> 集合与文档操作</h4><ol><li><p>创建集合</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 创建集合</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.createCollection<span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 查看所有集合</span></pre></td></tr><tr><td data-num="4"></td><td><pre>show collections</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 查看所有集合（方式二）</span></pre></td></tr><tr><td data-num="6"></td><td><pre>show tables</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 创建固定集合</span></pre></td></tr><tr><td data-num="8"></td><td><pre>db.createCollection<span class="token punctuation">(</span><span class="token string">"col2"</span>,<span class="token punctuation">&#123;</span>capped:true,autoIndexId:true,size:6142800,max:10000<span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token comment"># 集合大小：6142800B，最大文档个数：10000</span></pre></td></tr></table></figure><blockquote><p>在 MongoDB 中，其实不需要显式创建集合，在插入文档时，MongoDB 就会自动创建集合。</p></blockquote></li><li><p>删除集合</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># db.collection.drop ()，返回布尔值</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col2.drop<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>文档基本操作</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 插入文档</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.insert<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>title: <span class="token string">'Telephone Book'</span>, user: <span class="token string">'Jason'</span>,mobile: <span class="token string">'138****2573'</span>,site: <span class="token string">'https://www.jason.com'</span>,label: <span class="token punctuation">[</span><span class="token string">'classmate'</span>, <span class="token string">'friend'</span><span class="token punctuation">]</span>,description: <span class="token string">''</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查看文档内容</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 也可以将数据定义为变量，然后插入该变量</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token assign-left variable">jason_document</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>title: <span class="token string">'Telephone Book'</span>, user: <span class="token string">'Jason'</span>,mobile: <span class="token string">'138****2573'</span>,site: <span class="token string">'https://www.jason.com'</span>,label: <span class="token punctuation">[</span><span class="token string">'classmate'</span>, <span class="token string">'friend'</span><span class="token punctuation">]</span>,description: <span class="token string">''</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>db.col.insert<span class="token punctuation">(</span>jason_document<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># v3.2 版本之后新增了 insertOne 和 insertMany 方法</span></pre></td></tr><tr><td data-num="9"></td><td><pre>db.col2.insertOne<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"Lily"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre>db.col2.insertMany<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"Charles"</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span><span class="token string">"name"</span><span class="token builtin class-name">:</span> <span class="token string">"James"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p>save 方法也可以创建文档。</p></blockquote></li><li><p>更新文档</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 参数（1. 筛选条件，2. 更新内容，3.***，4.***）</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.update<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'title'</span><span class="token builtin class-name">:</span><span class="token string">'Telephone Book'</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span><span class="token variable">$set</span>:<span class="token punctuation">&#123;</span><span class="token string">'title'</span><span class="token builtin class-name">:</span><span class="token string">'Telephone Book: Jason'</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span> <span class="token comment"># 查询标题为 Telephone Book 的数据，并更新标题</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 同时更新多条文档内容</span></pre></td></tr><tr><td data-num="4"></td><td><pre>db.col.update<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'user'</span><span class="token builtin class-name">:</span><span class="token string">'Jason'</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span><span class="token variable">$set</span>:<span class="token punctuation">&#123;</span><span class="token string">'title'</span><span class="token builtin class-name">:</span><span class="token string">'Telephone Book: Jason'</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span>multi:true<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># save（如果指定了 _id 字段，则更新对应文档，如果未指定，则新增文档）</span></pre></td></tr><tr><td data-num="7"></td><td><pre>db.col.save<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"_id"</span> <span class="token builtin class-name">:</span> ObjectId<span class="token punctuation">(</span><span class="token string">"61c9ad7bba2a467651726dba"</span><span class="token punctuation">)</span>,title: <span class="token string">'Telephone Book: Bill'</span>, user: <span class="token string">'Bill'</span>,mobile: <span class="token string">'187****0966'</span>,site: <span class="token string">'https://www.bill.com'</span>,label: <span class="token punctuation">[</span><span class="token string">'classmate'</span><span class="token punctuation">]</span>,description: <span class="token string">''</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># 查询并格式化显示</span></pre></td></tr></table></figure><blockquote><p>使用 save 方法更新文档时，文档内所有字段都会被更新，即 save 中未指定字段会被移除，save 指定但数据库不存在字段会被新增。</p></blockquote></li><li><p>删除文档</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 删除指定数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.remove<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">'user'</span><span class="token builtin class-name">:</span><span class="token string">'Jason'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 删除所有</span></pre></td></tr><tr><td data-num="4"></td><td><pre>db.col.remove<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>查询文档</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询所有</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 查询并返回指定的键</span></pre></td></tr><tr><td data-num="4"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span><span class="token string">"title"</span>:1,_id:0<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 查询并格式化显示</span></pre></td></tr><tr><td data-num="7"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">)</span>.pretty<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 查询一条</span></pre></td></tr><tr><td data-num="9"></td><td><pre>db.col.findOne<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>比较查询：</p><table><thead><tr><th style="text-align:left">操作</th><th style="text-align:left">格式</th><th style="text-align:left">示例</th></tr></thead><tbody><tr><td style="text-align:left">等于</td><td style="text-align:left"><code>&#123;&lt;key&gt;:&lt;value&gt;&#125;</code></td><td style="text-align:left">db.col.find({&quot;title&quot;:&quot;John&quot;})</td></tr><tr><td style="text-align:left">小于</td><td style="text-align:left"><code>&#123;&lt;key&gt;:&#123;$lt:&lt;value&gt;&#125;&#125;</code></td><td style="text-align:left">db.col.find({&quot;age&quot;:{$lt:18}})</td></tr><tr><td style="text-align:left">小于等于</td><td style="text-align:left"><code>&#123;&lt;key&gt;:&#123;$lte:&lt;value&gt;&#125;&#125;</code></td><td style="text-align:left">db.col.find({&quot;age&quot;:{$lte:18}})</td></tr><tr><td style="text-align:left">大于</td><td style="text-align:left"><code>&#123;&lt;key&gt;:&#123;$gt:&lt;value&gt;&#125;&#125;</code></td><td style="text-align:left">db.col.find({&quot;age&quot;:{$gt:18}})</td></tr><tr><td style="text-align:left">大于等于</td><td style="text-align:left"><code>&#123;&lt;key&gt;:&#123;$gte:&lt;value&gt;&#125;&#125;</code></td><td style="text-align:left">db.col.find({&quot;age&quot;:{$gte:18}})</td></tr><tr><td style="text-align:left">不等于</td><td style="text-align:left"><code>&#123;&lt;key&gt;:&#123;$ne:&lt;value&gt;&#125;&#125;</code></td><td style="text-align:left">db.col.find({&quot;age&quot;:{$ne:18}})</td></tr></tbody></table><p>这些比较查询语句，类似于关系型数据库中的 <code>select * from col where age &gt; 18;</code> 。</p><p>AND 和 OR：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># AND</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>key1:value1, key2:value2<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># OR</span></pre></td></tr><tr><td data-num="4"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token variable">$or</span>:<span class="token punctuation">[</span><span class="token punctuation">&#123;</span>key1: value1<span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span>key2:value2<span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># AND 和 OR 联合使用</span></pre></td></tr><tr><td data-num="6"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"site"</span><span class="token builtin class-name">:</span> <span class="token string">"https://www.jason.com"</span>, <span class="token variable">$or</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"user"</span><span class="token builtin class-name">:</span> <span class="token string">"Jason"</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span><span class="token string">"age"</span><span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token variable">$gt</span>:18<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li></ol><h3 id="进阶操作"><a class="anchor" href="#进阶操作">#</a> 进阶操作</h3><h4 id="type"><a class="anchor" href="#type">#</a> $type</h4><p><img data-src="https://img.xfc-exclave.com/2021/12/150a87c9c43d3543ba943f30492c02af1640610969.png" alt="image-20211227211354948"></p><p>使用示例：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询 title 类型为 string 的数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"title"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token variable">$type</span> <span class="token builtin class-name">:</span> <span class="token number">2</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 等价于</span></pre></td></tr><tr><td data-num="4"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"title"</span> <span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token variable">$type</span> <span class="token builtin class-name">:</span> <span class="token string">'string'</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="limit-和-skip"><a class="anchor" href="#limit-和-skip">#</a> limit 和 skip</h4><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询 2 条记录</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span><span class="token string">"user"</span>:1,_id:0<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>.limit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 跳过 1 条数，并查询其后续的 2 条记录</span></pre></td></tr><tr><td data-num="4"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span><span class="token string">"user"</span>:1,_id:0<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>.limit<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>.skip<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="排序"><a class="anchor" href="#排序">#</a> 排序</h4><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 排序使用 1 和 - 1 来分别表示正序和倒叙</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>,<span class="token punctuation">&#123;</span><span class="token string">"user"</span>:1,_id:0<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>.sort<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"age"</span>:-1<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="索引"><a class="anchor" href="#索引">#</a> 索引</h4><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 根据键名 user 按顺序创建索引，1 为升序，-1 为降序</span></pre></td></tr><tr><td data-num="2"></td><td><pre>db.col.createIndex<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"user"</span>:-1<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 复合索引</span></pre></td></tr><tr><td data-num="4"></td><td><pre>db.col.createIndex<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"title"</span>:1,<span class="token string">"description"</span>:-1<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 查看集合索引</span></pre></td></tr><tr><td data-num="6"></td><td><pre>db.col.getIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 查看集合索引大小</span></pre></td></tr><tr><td data-num="8"></td><td><pre>db.col.totalIndexSize<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 删除所有集合索引</span></pre></td></tr><tr><td data-num="10"></td><td><pre>db.col.dropIndexes<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># 删除集合指定索引</span></pre></td></tr><tr><td data-num="12"></td><td><pre>db.col.dropIndex<span class="token punctuation">(</span><span class="token string">"myindex"</span><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p>创建索引还可以接受许多参数，如索引名称、是否唯一、设置过期时间等，详情可自行参考<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29tL21hbnVhbC9yZWZlcmVuY2UvY29tbWFuZC9jcmVhdGVJbmRleGVz">官方文档</span>。</p></blockquote><h4 id="聚合"><a class="anchor" href="#聚合">#</a> 聚合</h4><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>db.mypost.aggregate<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token variable">$group</span> <span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span>_id <span class="token builtin class-name">:</span> <span class="token string">"<span class="token variable">$author</span>"</span>, post_count <span class="token builtin class-name">:</span> <span class="token punctuation">&#123;</span><span class="token variable">$sum</span> <span class="token builtin class-name">:</span> <span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 类似于如下 SQL</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">select</span> author, count<span class="token punctuation">(</span>*<span class="token punctuation">)</span> as post_count from mypost group by author</pre></td></tr></table></figure><ol><li><p>管道：</p><p>在此处的示例中， <code>$group</code> 是 MongoDB 管道的一种，MongoDB 的聚合管道将 MongoDB 文档在一个管道处理完毕后将结果传递给下一个管道处理，并且管道操作是可以重复的。</p><p>常用管道操作符：</p><ul><li>$project：修改输入文档的结构。可以用来重命名、增加或删除域，也可以用于创建计算结果以及嵌套文档。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>t</mi><mi>c</mi><mi>h</mi><mtext>：用于过滤数据，只输出符合条件的文档。</mtext></mrow><annotation encoding="application/x-tex">match：用于过滤数据，只输出符合条件的文档。</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">c</span><span class="mord mathnormal">h</span><span class="mord cjk_fallback">：</span><span class="mord cjk_fallback">用</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">过</span><span class="mord cjk_fallback">滤</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">只</span><span class="mord cjk_fallback">输</span><span class="mord cjk_fallback">出</span><span class="mord cjk_fallback">符</span><span class="mord cjk_fallback">合</span><span class="mord cjk_fallback">条</span><span class="mord cjk_fallback">件</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">文</span><span class="mord cjk_fallback">档</span><span class="mord cjk_fallback">。</span></span></span></span>match 使用 MongoDB 的标准查询操作。</li><li>$limit：用来限制 MongoDB 聚合管道返回的文档数。</li><li>$skip：在聚合管道中跳过指定数量的文档，并返回余下的文档。</li><li>$unwind：将文档中的某一个数组类型字段拆分成多条，每条包含数组中的一个值。</li><li>$group：将集合中的文档分组，可用于统计结果。</li><li>$sort：将输入文档排序后输出。</li><li>$geoNear：输出接近某一地理位置的有序文档。</li></ul></li><li><p>表达式：</p><p>此处示例中的 <code>$sum</code> 即是表示聚合操作的表达式。</p><p>常用表达式：</p><ul><li>$sum：计算总和。</li><li>$avg：计算平均值</li><li>$min：获取集合中所有文档对应值得最小值。</li><li>$max：获取集合中所有文档对应值得最大值。</li><li>$push：将值加入一个数组中，不会判断是否有重复的值。</li><li>$addToSet：将值加入一个数组中，会判断是否有重复的值，若相同的值在数组中已经存在了，则不加入。</li><li>$first：根据资源文档的排序获取第一个文档数据。</li><li>$last：根据资源文档的排序获取最后一个文档数据</li></ul></li></ol><h4 id="复制副本集"><a class="anchor" href="#复制副本集">#</a> 复制（副本集）</h4><p>MongoDB 复制是将数据同步在多个服务器的过程。复制提供了数据的冗余备份，并在多个服务器上存储数据副本，提高了数据的可用性， 并可以保证数据的安全性。复制还允许您从硬件故障和服务中断中恢复数据。</p><p><strong>MongoDB 复制原理：</strong></p><p>MongoDB 复制至少需要两个节点，其中一个是主节点，负责处理客户端请求，其余的都是从节点，负责复制主节点上的数据。</p><p>主节点记录在其上的所有操作 oplog，从节点定期轮询主节点获取这些操作，然后对自己的数据副本执行这些操作，从而保证从节点的数据与主节点一致。</p><p>MongoDB 复制结构图如下所示：</p><p><img data-src="https://img.xfc-exclave.com/2021/12/3ff8e97233badeaa61c8cc333404a57b1640616478.png" alt="image-20211227222410409"></p><p>副本集具有如下特征：</p><ul><li>N 个节点的集群</li><li>任何节点可作为主节点</li><li>所有写入操作都在主节点上</li><li>自动故障转移</li><li>自动恢复</li></ul><p><strong>副本集设置：</strong></p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 启动一个名为 rs0 的 MongoDB 实例</span></pre></td></tr><tr><td data-num="2"></td><td><pre>mongod --port <span class="token number">27017</span> --dbpath <span class="token string">"A:\MongoDB\Server<span class="token entity" title="\5">\5</span>.0\data"</span> --replSet rs0</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 客户端连接并启动一个新的副本集</span></pre></td></tr><tr><td data-num="4"></td><td><pre>rs.initiate<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 查看副本集配置</span></pre></td></tr><tr><td data-num="6"></td><td><pre>rs.conf<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 查看副本集状态</span></pre></td></tr><tr><td data-num="8"></td><td><pre>rs.status<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p><strong>添加副本集成员：</strong></p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 副本集添加成员</span></pre></td></tr><tr><td data-num="2"></td><td><pre>rs.add<span class="token punctuation">(</span><span class="token string">"192.168.0.101:27017"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment"># 判断当前运行的 Mongo 服务是否为主节点</span></pre></td></tr><tr><td data-num="4"></td><td><pre>db.isMaster<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><blockquote><p>MongoDB 中你只能通过主节点将 Mongo 服务添加到副本集中，并且，MongoDB 的副本集与我们常见的主从有所不同，主从在主机宕机后所有服务将停止，而副本集在主机宕机后，副本会接管主节点成为主节点。</p></blockquote><h4 id="分片"><a class="anchor" href="#分片">#</a> 分片</h4><p>MongoDB 中存在一种分片技术，它可以通过在多台机器上分割数据的方式，来使得数据库系统能存储和处理更多的数据或提高读写吞吐量。</p><p>分片结构集群部署图例：</p><p><img data-src="https://img.xfc-exclave.com/2021/12/d2d8f131c1e59a0a634c2953b12c1b891640618022.png" alt="image-20211227231337940"></p><p>组件说明：</p><ul><li>Shard：用于存储实际的数据块，实际生产环境中一个 shard server 角色可由几台机器组个一个 replica set 承担，防止主机单点故障。</li><li>Config Servers：mongod 实例，存储了整个 ClusterMetadata，其中包括 chunk 信息。</li><li>Query Routers：前端路由，客户端由此接入，且让整个集群看上去像单一数据库，前端应用可以透明使用。</li></ul><p><span class="label danger">❗️TODO</span> 未完待补充</p><h4 id="备份与恢复"><a class="anchor" href="#备份与恢复">#</a> 备份与恢复</h4><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 数据备份，语法：mongodump -h &lt;hostname>&lt;:port> -d dbname -o &lt;path></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 不指定参数，则连接本地 27017 端口服务，默认备份到目录 [mongodb]/bin/dump/ 中</span></pre></td></tr><tr><td data-num="3"></td><td><pre>mongodump</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 备份恢复，语法：mongorestore -h &lt;hostname>&lt;:port> -d dbname &lt;path></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 不指定参数，则连接本地 27017 端口服务，默认从目录 [mongodb]/bin/dump/ 中获取备份文件</span></pre></td></tr><tr><td data-num="6"></td><td><pre>mongorestore</pre></td></tr></table></figure><h4 id="监控"><a class="anchor" href="#监控">#</a> 监控</h4><p><code>mongostat</code> 是 MongoDB 自带的状态检测工具，在命令行下使用。它会间隔固定时间获取 MongoDB 的当前运行状态，并输出。</p><p>使用方式：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>mongostat <span class="token comment"># 无密码监控默认数据库</span></pre></td></tr><tr><td data-num="2"></td><td><pre>mongostat -uroot -p123456 --authenticationDatabase<span class="token operator">=</span>admin</pre></td></tr></table></figure><blockquote><p>如提示 command serverStatus requires authentication，那么多半是因为 MongoDB 需要登录权限，详情可通过命令 <code>mongostat --help</code> 查看。</p></blockquote><p><code>mongotop</code> 也是 MongoDB 下的一个内置工具，mongotop 提供了一个方法，用来跟踪一个 MongoDB 的实例，查看哪些大量的时间花费在读取和写入数据。 mongotop 提供每个集合的水平的统计数据。默认情况下，mongotop 返回值的每一秒。</p><p>使用方式：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>mongotop <span class="token comment"># 无密码监控默认数据库</span></pre></td></tr><tr><td data-num="2"></td><td><pre>mongotop -uroot -p123456 --authenticationDatabase<span class="token operator">=</span>admin</pre></td></tr><tr><td data-num="3"></td><td><pre>mongotop -uroot -p123456 --authenticationDatabase<span class="token operator">=</span>admin --lock <span class="token comment"># 监控各个数据库锁使用情况</span></pre></td></tr></table></figure><h3 id="api"><a class="anchor" href="#api">#</a> API</h3><h4 id="java-api"><a class="anchor" href="#java-api">#</a> Java API</h4><blockquote><p>此处 MongoDB Java API 以 SpringBoot 框架作为示例。</p></blockquote><p>准备工作：</p><ol><li><p>使用 SpringInitializer 创建一个测试项目。</p></li><li><p>配置依赖包。</p><figure class="highlight xml"><figcaption data-lang="XML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-data-mongodb<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span></pre></td></tr></table></figure></li><li><p>启动文件配置：</p><figure class="highlight yaml"><figcaption data-lang="YAML"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token key atrule">spring</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>  <span class="token key atrule">data</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token key atrule">mongodb</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      <span class="token key atrule">uri</span><span class="token punctuation">:</span> <span class="token string">"mongodb://localhost:27017/test"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token comment"># 如未设置则不需要指定用户名及密码</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token comment"># username:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token comment"># password:</span></pre></td></tr></table></figure></li><li><p>创建用于测试的实体类：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Data</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">//id 会被映射为 mongodb 文档的主键</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li></ol><p>基础增删改查：</p><ol><li><p>创建接口：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token class-name">User</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token class-name">User</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token class-name">User</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p>实现类：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Service</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token annotation punctuation">@Autowired</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">MongoTemplate</span> mongoTemplate<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token class-name">DeleteResult</span> result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">getDeletedCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p>提供 API 访问：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@RestController</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token annotation punctuation">@Autowired</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/list"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/insert"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">insert</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/save"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">save</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/update"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/remove"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>userService<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p>测试发送请求：</p><figure class="highlight http"><figcaption data-lang="HTTP"></figcaption><table><tr><td data-num="1"></td><td><pre>### 添加用户</pre></td></tr><tr><td data-num="2"></td><td><pre>POST http://localhost:8080/insert?name=Lily&amp;age=21</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token header-name keyword">Accept:</span> application/json</pre></td></tr><tr><td data-num="4"></td><td><pre>###</pre></td></tr><tr><td data-num="5"></td><td><pre>POST http://localhost:8080/insert?name=Mike&amp;age=26</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token header-name keyword">Accept:</span> application/json</pre></td></tr><tr><td data-num="7"></td><td><pre>###</pre></td></tr><tr><td data-num="8"></td><td><pre>POST http://localhost:8080/insert?name=Jason&amp;age=27</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token header-name keyword">Accept:</span> application/json</pre></td></tr><tr><td data-num="10"></td><td><pre>###</pre></td></tr><tr><td data-num="11"></td><td><pre>POST http://localhost:8080/insert?name=Philips&amp;age=14</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token header-name keyword">Accept:</span> application/json</pre></td></tr><tr><td data-num="13"></td><td><pre>### 添加</pre></td></tr><tr><td data-num="14"></td><td><pre>POST http://localhost:8080/save?name=Jill&amp;age=28</pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token header-name keyword">Accept:</span> application/json</pre></td></tr><tr><td data-num="16"></td><td><pre>### 修改</pre></td></tr><tr><td data-num="17"></td><td><pre>POST http://localhost:8080/save?name=Jill&amp;age=28&amp;id=61caf27055120f6b62234917</pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token header-name keyword">Accept:</span> application/json</pre></td></tr><tr><td data-num="19"></td><td><pre>### 修改</pre></td></tr><tr><td data-num="20"></td><td><pre>POST http://localhost:8080/update?name=Tom&amp;age=33&amp;id=61caf27055120f6b62234917</pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token header-name keyword">Accept:</span> application/json</pre></td></tr><tr><td data-num="22"></td><td><pre>### 查询列表</pre></td></tr><tr><td data-num="23"></td><td><pre>GET http://localhost:8080/list</pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token header-name keyword">Accept:</span> application/json</pre></td></tr></table></figure></li></ol><p>扩展查询：</p><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 单一条件查询示例</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">queryById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回一条</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">// 符合条件查询示例</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">queryByCondition</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token class-name">Criteria</span> criteria <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Criteria</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    criteria<span class="token punctuation">.</span><span class="token function">orOperator</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token class-name">Query</span><span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token comment">// 排序</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token class-name">Sort</span> sort <span class="token operator">=</span> <span class="token class-name">Sort</span><span class="token punctuation">.</span><span class="token function">by</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Sort<span class="token punctuation">.</span>Order</span><span class="token punctuation">(</span><span class="token class-name">Sort<span class="token punctuation">.</span>Direction</span><span class="token punctuation">.</span>DESC<span class="token punctuation">,</span> <span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    query<span class="token punctuation">.</span><span class="token keyword">with</span><span class="token punctuation">(</span>sort<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 返回多条</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token comment">// 分页查询</span></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">queryWithPage</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> limit<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    query<span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>limit<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 从下标为 index 开始查询接下来的 limit 条数据</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token comment">// 模糊查询</span></pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">></span></span> <span class="token function">like</span><span class="token punctuation">(</span><span class="token class-name">String</span> chars<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">regex</span><span class="token punctuation">(</span>chars<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// 查询 name 中包含指定字符的数据</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token comment">// 查询并删除</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="38"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">queryToRemove</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token class-name">Query</span> query <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token class-name">Criteria</span><span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token class-name">DeleteResult</span> result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mongoTemplate<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token keyword">return</span> result<span class="token punctuation">.</span><span class="token function">getDeletedCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="42"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><blockquote><p>更多 Java API 用法，请查询 <span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnNwcmluZy5pby9zcHJpbmctZGF0YS9tb25nb2RiL2RvY3MvY3VycmVudC9hcGkvb3JnL3NwcmluZ2ZyYW1ld29yay9kYXRhL21vbmdvZGIvY29yZS9Nb25nb1RlbXBsYXRlLmh0bWw=">spring-boot-starter-data-mongodb 文档</span>。</p></blockquote><h4 id="python-api"><a class="anchor" href="#python-api">#</a> Python API</h4><ol><li><p>安装 pymongo 连接工具：</p><figure class="highlight shell"><figcaption data-lang="Bash"></figcaption><table><tr><td data-num="1"></td><td><pre>python3 -m pip3 <span class="token function">install</span> pymongo</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># 如需更新，执行如下命令：</span></pre></td></tr><tr><td data-num="3"></td><td><pre>python3 -m pip3 <span class="token function">install</span> --upgrade pymongo</pre></td></tr></table></figure></li><li><p>数据库与集合操作：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/python3</span></pre></td></tr><tr><td data-num="2"></td><td><pre> </pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> pymongo</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 建立连接</span></pre></td></tr><tr><td data-num="6"></td><td><pre>myclient <span class="token operator">=</span> pymongo<span class="token punctuation">.</span>MongoClient<span class="token punctuation">(</span><span class="token string">"mongodb://localhost:27017/"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment"># 创建数据库</span></pre></td></tr><tr><td data-num="8"></td><td><pre>mydb <span class="token operator">=</span> myclient<span class="token punctuation">[</span><span class="token string">"test"</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment"># 查询数据库列表</span></pre></td></tr><tr><td data-num="10"></td><td><pre>dblist <span class="token operator">=</span> myclient<span class="token punctuation">.</span>list_database_names<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment"># dblist = myclient.database_names() </span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">if</span> <span class="token string">"test"</span> <span class="token keyword">in</span> dblist<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"数据库已存在！"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># 创建集合</span></pre></td></tr><tr><td data-num="16"></td><td><pre>mydb <span class="token operator">=</span> myclient<span class="token punctuation">[</span><span class="token string">"test"</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="17"></td><td><pre>mycol <span class="token operator">=</span> mydb<span class="token punctuation">[</span><span class="token string">"col"</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token comment"># 查询集合列表</span></pre></td></tr><tr><td data-num="19"></td><td><pre>collist <span class="token operator">=</span> mydb<span class="token punctuation">.</span>list_collection_names<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">if</span> <span class="token string">"col"</span> <span class="token keyword">in</span> collist<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"集合已存在！"</span><span class="token punctuation">)</span></pre></td></tr></table></figure></li><li><p>增删改查</p><p>新增：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 插入一条数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre>mydict <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Chinmoku"</span><span class="token punctuation">,</span> <span class="token string">"site"</span><span class="token punctuation">:</span> <span class="token string">"https://www.chinmoku.cc"</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>x <span class="token operator">=</span> mycol<span class="token punctuation">.</span>insert_one<span class="token punctuation">(</span>mydict<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>inserted_id<span class="token punctuation">)</span>  <span class="token comment"># 文档数据 ID</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 插入多条数据</span></pre></td></tr><tr><td data-num="7"></td><td><pre>mylist <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Facebook"</span><span class="token punctuation">,</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"https://www.facebook.com"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"知乎"</span><span class="token punctuation">,</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"https://www.zhihu.com"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Github"</span><span class="token punctuation">,</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"https://www.github.com"</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="12"></td><td><pre>x <span class="token operator">=</span> mycol<span class="token punctuation">.</span>insert_many<span class="token punctuation">(</span>mylist<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>inserted_ids<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment"># 也可以指定 ID</span></pre></td></tr><tr><td data-num="16"></td><td><pre>mylist <span class="token operator">=</span> <span class="token punctuation">[</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"百度"</span><span class="token punctuation">,</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"https://www.baidu.com"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="18"></td><td><pre>  <span class="token punctuation">&#123;</span> <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Google"</span><span class="token punctuation">,</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token string">"https://www.google.com"</span><span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="20"></td><td><pre>x <span class="token operator">=</span> mycol<span class="token punctuation">.</span>insert_many<span class="token punctuation">(</span>mylist<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>inserted_ids<span class="token punctuation">)</span></pre></td></tr></table></figure><p>删除：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 删除单条</span></pre></td></tr><tr><td data-num="2"></td><td><pre>myquery <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"百度"</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>mycol<span class="token punctuation">.</span>delete_one<span class="token punctuation">(</span>myquery<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># 删除多条 (删除 http 协议网站)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>myquery <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"$regex"</span><span class="token punctuation">:</span> <span class="token string">"^http:"</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>x <span class="token operator">=</span> mycol<span class="token punctuation">.</span>delete_many<span class="token punctuation">(</span>myquery<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已删除文档个数："</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>deleted_count<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment"># 删除所有文档</span></pre></td></tr><tr><td data-num="11"></td><td><pre>x <span class="token operator">=</span> mycol<span class="token punctuation">.</span>delete_many<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token comment"># 删除集合</span></pre></td></tr><tr><td data-num="14"></td><td><pre>mycol<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>修改：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 修改单条</span></pre></td></tr><tr><td data-num="2"></td><td><pre>myquery <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"id"</span><span class="token punctuation">:</span> <span class="token string">"1"</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>newvalues <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"$set"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"No 1"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>mycol<span class="token punctuation">.</span>update_one<span class="token punctuation">(</span>myquery<span class="token punctuation">,</span> newvalues<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># 修改多条</span></pre></td></tr><tr><td data-num="7"></td><td><pre>myquery <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"$regex"</span><span class="token punctuation">:</span> <span class="token string">"^http:"</span><span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>newvalues <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"$set"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"非HTTPS协议网站"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>x <span class="token operator">=</span> mycol<span class="token punctuation">.</span>update_many<span class="token punctuation">(</span>myquery<span class="token punctuation">,</span> newvalues<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"已更新文档个数："</span><span class="token punctuation">,</span> x<span class="token punctuation">.</span>modified_count<span class="token punctuation">)</span></pre></td></tr></table></figure><p>查询：</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment"># 查询文档第一条数据</span></pre></td></tr><tr><td data-num="2"></td><td><pre>x <span class="token operator">=</span> mycol<span class="token punctuation">.</span>find_one<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment"># 查询文档所有数据</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">for</span> x <span class="token keyword">in</span> mycol<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment"># 查询指定字段（指定 1，表示需要返回的字段），注意，除_id 外，其他字段不能 0 或 1 必须一致</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">for</span> x <span class="token keyword">in</span> mycol<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"_id"</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token number">1</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token comment"># 反向返回字段（返回除 url 之外的其他字段）</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token keyword">for</span> x <span class="token keyword">in</span> mycol<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span> <span class="token string">"url"</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment"># 根据条件查询</span></pre></td></tr><tr><td data-num="17"></td><td><pre>myquery <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"Chinmoku"</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>mydoc <span class="token operator">=</span> mycol<span class="token punctuation">.</span>find<span class="token punctuation">(</span>myquery<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">for</span> x <span class="token keyword">in</span> mydoc<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre><span class="token comment"># 使用修饰符查询（比较 name 首字母）</span></pre></td></tr><tr><td data-num="23"></td><td><pre>myquery <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token string">"$gt"</span><span class="token punctuation">:</span> <span class="token string">"H"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>mydoc <span class="token operator">=</span> mycol<span class="token punctuation">.</span>find<span class="token punctuation">(</span>myquery<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token keyword">for</span> x <span class="token keyword">in</span> mydoc<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment"># 正则查询（查询 name 以 C 开头的数据）</span></pre></td></tr><tr><td data-num="29"></td><td><pre>myquery <span class="token operator">=</span> <span class="token punctuation">&#123;</span> <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span> <span class="token string">"$regex"</span><span class="token punctuation">:</span> <span class="token string">"^C"</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>mydoc <span class="token operator">=</span> mycol<span class="token punctuation">.</span>find<span class="token punctuation">(</span>myquery<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token keyword">for</span> x <span class="token keyword">in</span> mydoc<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre><span class="token comment"># 返回指定条数</span></pre></td></tr><tr><td data-num="35"></td><td><pre>myresult <span class="token operator">=</span> mycol<span class="token punctuation">.</span>find<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>limit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">for</span> x <span class="token keyword">in</span> myresult<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre>  <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span></pre></td></tr></table></figure></li></ol><h3 id="参考"><a class="anchor" href="#参考">#</a> 参考</h3><ul><li><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLm1vbmdvZGIuY29t">https://docs.mongodb.com</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cucnVub29iLmNvbS9tb25nb2Ri">https://www.runoob.com/mongodb</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cubXJoZWxsb3dvcmxkLmNvbS9tb25nb2Ri">https://www.mrhelloworld.com/mongodb</span></li><li><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vaGV4cnVpL3AvMTQ4ODU3ODUuaHRtbA==">https://www.cnblogs.com/hexrui/p/14885785.html</span></li><li><span class="exturl" data-url="aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2ExMTIwNDY3ODAwL2FydGljbGUvZGV0YWlscy8xMDk5NTQxNDU=">https://blog.csdn.net/a1120467800/article/details/109954145</span></li></ul><div class="tags"><a href="/tags/java/" rel="tag"><i class="ic i-tag"></i> java</a></div></div><footer><div class="meta"><span id="computer-science/java-learning-path/3-advanced/mongodb-tutorial/" class="item leancloud_visitors" data-flag-title="MongoDB 基础教程" title="閲覧数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">閲覧数</span> <span class="leancloud-visitors-count"></span> <span class="text">回</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 寄付</button><p>*~(￣▽￣)~[お茶]を一杯ください</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="チンモク WeChat 支払う"><p>WeChat 支払う</p></div><div><img data-src="/images/alipay.png" alt="チンモク Alipay"><p>Alipay</p></div><div><img data-src="/images/paypal.png" alt="チンモク PayPal"><p>PayPal</p></div></div></div><div id="copyright"><ul><li class="author"><strong>著者： </strong>チンモク <i class="ic i-at"><em>@</em></i>チンモクのブログ</li><li class="link"><strong>記事へのリンク：</strong> <a href="https://www.chinmoku.cc/computer-science/java-learning-path/3-advanced/mongodb-tutorial/" title="MongoDB 基础教程">https://www.chinmoku.cc/computer-science/java-learning-path/3-advanced/mongodb-tutorial/</a></li><li class="license"><strong>著作権表示： </strong>このブログ内のすべての記事は、特別な記載がない限り <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> の下のライセンスで保護されています。</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/computer-science/python/django-tutorial/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;reference-1301046789.cos.ap-nanjing.myqcloud.com&#x2F;blog-img&#x2F;24632098880711ebb6edd017c2d2eca2.jpg" title="Django 网站全栈开发教程"><span class="type">前の記事</span> <span class="category"><i class="ic i-flag"></i> Python 入门教程</span><h3>Django 网站全栈开发教程</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="見出し"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#nosql-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">NoSQL 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#nosql-%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">NoSQL 优缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rdbms-vs-nosql"><span class="toc-number">1.2.</span> <span class="toc-text">RDBMS vs NoSQL</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mongodb-%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">MongoDB 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mongodb-%E4%B8%BB%E8%A6%81%E7%89%B9%E7%82%B9"><span class="toc-number">2.1.</span> <span class="toc-text">MongoDB 主要特点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mongodb-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">2.2.</span> <span class="toc-text">MongoDB 数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mongodb-%E6%94%AF%E6%8C%81%E8%AF%AD%E8%A8%80"><span class="toc-number">2.3.</span> <span class="toc-text">MongoDB 支持语言</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E4%B8%8E%E5%AE%89%E8%A3%85"><span class="toc-number">3.</span> <span class="toc-text">下载与安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#windows-%E7%8E%AF%E5%A2%83"><span class="toc-number">3.1.</span> <span class="toc-text">Windows 环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#linux-%E7%8E%AF%E5%A2%83"><span class="toc-number">3.2.</span> <span class="toc-text">Linux 环境</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#mongodb-gui"><span class="toc-number">3.3.</span> <span class="toc-text">MongoDB GUI</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AF%E8%AF%AD%E4%B8%8E%E6%A6%82%E5%BF%B5"><span class="toc-number">4.</span> <span class="toc-text">术语与概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.1.</span> <span class="toc-text">数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E6%A1%A3"><span class="toc-number">4.2.</span> <span class="toc-text">文档</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88"><span class="toc-number">4.3.</span> <span class="toc-text">集合</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#capped-collections"><span class="toc-number">4.3.1.</span> <span class="toc-text">Capped Collections</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%83%E6%95%B0%E6%8D%AE"><span class="toc-number">4.4.</span> <span class="toc-text">元数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#objectid"><span class="toc-number">4.5.</span> <span class="toc-text">ObjectId</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%97%B4%E4%B8%8E%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">4.6.</span> <span class="toc-text">时间与字符串</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="toc-number">5.</span> <span class="toc-text">基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">5.1.</span> <span class="toc-text">数据库操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E4%B8%8E%E6%96%87%E6%A1%A3%E6%93%8D%E4%BD%9C"><span class="toc-number">5.2.</span> <span class="toc-text">集合与文档操作</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">进阶操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#type"><span class="toc-number">6.1.</span> <span class="toc-text">$type</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#limit-%E5%92%8C-skip"><span class="toc-number">6.2.</span> <span class="toc-text">limit 和 skip</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8E%92%E5%BA%8F"><span class="toc-number">6.3.</span> <span class="toc-text">排序</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95"><span class="toc-number">6.4.</span> <span class="toc-text">索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E5%90%88"><span class="toc-number">6.5.</span> <span class="toc-text">聚合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%8D%E5%88%B6%E5%89%AF%E6%9C%AC%E9%9B%86"><span class="toc-number">6.6.</span> <span class="toc-text">复制（副本集）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%89%87"><span class="toc-number">6.7.</span> <span class="toc-text">分片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D"><span class="toc-number">6.8.</span> <span class="toc-text">备份与恢复</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%91%E6%8E%A7"><span class="toc-number">6.9.</span> <span class="toc-text">监控</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#api"><span class="toc-number">7.</span> <span class="toc-text">API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#java-api"><span class="toc-number">7.1.</span> <span class="toc-text">Java API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#python-api"><span class="toc-number">7.2.</span> <span class="toc-text">Python API</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">8.</span> <span class="toc-text">参考</span></a></li></ol></div><div class="related panel pjax" data-title="関連記事"><ul><li><a href="/computer-science/java-learning-path/3-advanced/activemq-tutorial/" rel="bookmark" title="ActiveMQ - 从下载安装到集群部署">ActiveMQ - 从下载安装到集群部署</a></li><li><a href="/computer-science/java-learning-path/3-advanced/rabbitmq-tutorial/" rel="bookmark" title="RabbitMQ - 从下载安装到集群部署">RabbitMQ - 从下载安装到集群部署</a></li><li class="active"><a href="/computer-science/java-learning-path/3-advanced/mongodb-tutorial/" rel="bookmark" title="MongoDB 基础教程">MongoDB 基础教程</a></li></ul></div><div class="overview panel" data-title="概要"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="チンモク" data-src="/images/avatar.jpg"><p class="name" itemprop="name">チンモク</p><div class="description" itemprop="description">本站主要以 Java 开发总结文章为主，也会向技术周边进行适当的扩展。此外，偶尔会更新部分其他学习或感兴趣的内容，如语言学习、文本翻译、文艺创作等。</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">20</span> <span class="name">ポスト</span></a></div><div class="item categories"><a href="/categories/"><span class="count">13</span> <span class="name">カテゴリ</span></a></div><div class="item tags"><a href="/tags/"><span class="count">17</span> <span class="name">タグ</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3hmYy1leGNsYXZl" title="https:&#x2F;&#x2F;github.com&#x2F;xfc-exclave"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;twitter.com&#x2F;yourname"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;yourname"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTExMjg2ODg2Mw==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;112868863"><i class="ic i-cloud-music"></i></span> <span class="exturl item weibo" data-url="aHR0cHM6Ly93ZWliby5jb20vYW1laGltZQ==" title="https:&#x2F;&#x2F;weibo.com&#x2F;amehime"><i class="ic i-weibo"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnhmY19leGNsYXZlQDE2My5jb20=" title="mailto:xfc_exclave@163.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>ホーム</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>投稿</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>アーカイブ</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>カテゴリ</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>タグ</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-link-circle"></i>リンク</a><ul class="submenu"><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友人帳</a></li><li class="item"><a href="/websites/" rel="section"><i class="ic i-sun"></i>サイト</a></li></ul></li><li class="item"><a href="/plan/" rel="section"><i class="ic i-stars"></i>学習計画</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>ランダムな記事</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E9%AB%98%E7%BA%A7%E7%AF%87/" title="カテゴリ 高级篇">高级篇</a></div><span><a href="/computer-science/java-learning-path/3-advanced/activemq-tutorial/" title="ActiveMQ - 从下载安装到集群部署">ActiveMQ - 从下载安装到集群部署</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E5%9F%BA%E7%A1%80%E7%AF%87/" title="カテゴリ 基础篇">基础篇</a></div><span><a href="/computer-science/java-learning-path/1-basic/02-java-concurrency/" title="Java 并发编程知识整理">Java 并发编程知识整理</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/language/" title="カテゴリ 语言学习">语言学习</a> <i class="ic i-angle-right"></i> <a href="/categories/language/japanese/" title="カテゴリ 日语">日语</a> <i class="ic i-angle-right"></i> <a href="/categories/language/japanese/standard-japanese/" title="カテゴリ 標準日本語入門">標準日本語入門</a></div><span><a href="/language/japanese/standard-japanese/standard-japanese-02-ing/" title="標準日本語の入門（二）">標準日本語の入門（二）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E8%BF%9B%E9%98%B6%E7%AF%87/" title="カテゴリ 进阶篇">进阶篇</a></div><span><a href="/computer-science/java-learning-path/2-intermediate/spring-tutorial/" title="Spring 教程">Spring 教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/Python%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8B/" title="カテゴリ Python 入门教程">Python 入门教程</a></div><span><a href="/computer-science/python/django-tutorial/" title="Django 网站全栈开发教程">Django 网站全栈开发教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E5%9F%BA%E7%A1%80%E7%AF%87/" title="カテゴリ 基础篇">基础篇</a></div><span><a href="/computer-science/java-learning-path/3-advanced/zookeeper-tutorial/" title="Zookeeper 基础教程">Zookeeper 基础教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E8%BF%9B%E9%98%B6%E7%AF%87/" title="カテゴリ 进阶篇">进阶篇</a></div><span><a href="/computer-science/java-learning-path/2-intermediate/mybatis-tutorial/" title="MyBatis 教程">MyBatis 教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E5%9F%BA%E7%A1%80%E7%AF%87/" title="カテゴリ 基础篇">基础篇</a></div><span><a href="/computer-science/java-learning-path/1-basic/01-java-basic/" title="JAVA 基础知识大盘点">JAVA 基础知识大盘点</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E6%9E%B6%E6%9E%84%E7%AF%87/" title="カテゴリ 架构篇">架构篇</a></div><span><a href="/computer-science/java-learning-path/5-framework/docker-tutorial/" title="给，你要的 Docker 详细教程">给，你要的 Docker 详细教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="カテゴリ 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/" title="カテゴリ JAVA 学习路线">JAVA 学习路线</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/java-learning-path/%E8%BF%9B%E9%98%B6%E7%AF%87/" title="カテゴリ 进阶篇">进阶篇</a></div><span><a href="/computer-science/java-learning-path/2-intermediate/webservice-tutorial/" title="WebService，如此而已">WebService，如此而已</a></span></li></ul></div><div><h2>最近のコメント</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2020 – <span itemprop="copyrightYear">2021</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">チンモク @ Chinmoku</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="単語の総数">526k 単語</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="読書の合計時間">7:58</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"computer-science/java-learning-path/3-advanced/mongodb-tutorial/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"検索…",empty:"「 ${query} 」については何も見つかりませんでした",stats:"${time} ms以内に ${hits} 件の結果が見つかりました"},valine:!0,fancybox:!0,copyright:"コピーは成功しました。 <br> 再印刷については、 ％s 契約に従ってください。",ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html>